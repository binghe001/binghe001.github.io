<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第10章：自定义存储过程和函数 | 冰河技术</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/favicon.ico">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/global.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <script charset="utf-8" async="async" src="https://v1.cnzz.com/z_stat.php?id=1281063564&amp;web_id=1281063564"></script>
    <script charset="utf-8" async="async" src="https://s9.cnzz.com/z_stat.php?id=1281064551&amp;web_id=1281064551"></script>
    <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?d091d2fd0231588b1d0f9231e24e3f5e";
              var s = document.getElementsByTagName("script")[0];
              s.parentNode.insertBefore(hm, s);
            })();
            </script>
    <meta name="description" content="包含：编程语言，开发技术，分布式，微服务，高并发，高可用，高可扩展，高可维护，JVM技术，MySQL，分布式数据库，分布式事务，云原生，大数据，云计算，渗透技术，各种面试题，面试技巧...">
    <meta property="article:modified_time" content="2023-01-20T08:12:40.000Z">
    <meta property="og:title" content="第10章：自定义存储过程和函数">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html">
    <meta name="twitter:title" content="第10章：自定义存储过程和函数">
    <meta name="twitter:url" content="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="all">
    <meta name="author" content="冰河">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="冰河，冰河技术, 编程语言，开发技术，分布式，微服务，高并发，高可用，高可扩展，高可维护，JVM技术，MySQL，分布式数据库，分布式事务，云原生，大数据，云计算，渗透技术，各种面试题，面试技巧">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.06e10c60.css" as="style"><link rel="preload" href="/assets/css/styles.css?v=1674202622151" as="style"><link rel="preload" href="/assets/js/cg-styles.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-app.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-3.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-4.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-87.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-5.js?v=1674202622151" as="script"><link rel="preload" href="/assets/js/cg-6.js?v=1674202622151" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.06e10c60.css"><link rel="stylesheet" href="/assets/css/styles.css?v=1674202622151">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">冰河技术</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/md/all/all.html" class="nav-link">
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="核心技术" class="dropdown-title"><span class="title">核心技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          面试必问系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/interview/2022-04-18-001-面试必问-聊聊JVM性能调优.html" class="nav-link">
  面试必问
</a></li></ul></li><li class="dropdown-item"><h4>
          Java核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/java/basics/2022-04-28-全网最全正则表达式总结.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-subitem"><a href="/md/core/java/advanced/default.html" class="nav-link">
  Java进阶
</a></li><li class="dropdown-subitem"><a href="/md/core/java/senior/default.html" class="nav-link">
  Java高级
</a></li><li class="dropdown-subitem"><a href="/md/core/java/java8/2022-03-31-001-Java8有哪些新特性呢？.html" class="nav-link">
  Java8新特性
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/spring/ioc/2022-04-04-001-聊聊Spring注解驱动开发那些事儿.html" class="nav-link">
  IOC核心技术
</a></li><li class="dropdown-subitem"><a href="/md/core/spring/aop/default.html" class="nav-link">
  AOP核心技术
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/jvm/2022-04-18-001-JVM调优的几种场景.html" class="nav-link">
  JVM调优技术
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/mysql/base/2022-08-25-MySQL索引底层技术.html" class="nav-link">
  MySQL基础篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="性能调优" class="dropdown-title"><span class="title">性能调优</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/performance/jvm/default.html" class="nav-link">
  JVM性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/tomcat/default.html" class="nav-link">
  Tomcat性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/mysql/default.html" class="nav-link">
  MySQL性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/system/default.html" class="nav-link">
  操作系统性能调优
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="并发编程" class="dropdown-title"><span class="title">并发编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/concurrent/bottom/default.html" class="nav-link">
  底层技术
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/source/2020-03-30-001-一文搞懂线程与多线程.html" class="nav-link">
  源码分析
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/basics/2020-03-30-001-明明中断了线程，却为何不起作用呢？.html" class="nav-link">
  基础案例
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/ActualCombat/default.html" class="nav-link">
  实战案例
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/interview/default.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/framework/default.html" class="nav-link">
  系统架构
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥框架源码" class="dropdown-title"><span class="title">🔥框架源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/frame/spring/ioc/2022-12-02-《Spring核心技术》开篇-我要带你一步步调试Spring6.0源码啦.html" class="nav-link">
  🔥Spring核心技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          缓存技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/cache/default.html" class="nav-link">
  Redis
</a></li></ul></li><li class="dropdown-item"><h4>
          服务注册发现
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/zookeeper/default.html" class="nav-link">
  Zookeeper
</a></li></ul></li><li class="dropdown-item"><h4>
          消息中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/mq/rabbitmq/default.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/md/distributed/mq/rocketmq/default.html" class="nav-link">
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/md/distributed/mq/kafka/default.html" class="nav-link">
  Kafka
</a></li></ul></li><li class="dropdown-item"><h4>
          网络通信
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/netty/default.html" class="nav-link">
  Netty
</a></li></ul></li><li class="dropdown-item"><h4>
          远程调用
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/dubbo/default.html" class="nav-link">
  Dubbo
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/mongodb/default.html" class="nav-link">
  MongoDB
</a></li></ul></li><li class="dropdown-item"><h4>
          搜索引擎
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/es/default.html" class="nav-link">
  ElasticSearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥微服务" class="dropdown-title"><span class="title">🔥微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/microservices/springboot/default.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/md/microservices/springcloudalibaba/2022-04-02-SpringCloudAlibaba专栏开篇.html" class="nav-link">
  🔥SpringCloudAlibaba
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥项目实战" class="dropdown-title"><span class="title">🔥项目实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          微服务项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/microservices/springcloudalibaba/2022-04-02-SpringCloudAlibaba专栏开篇.html" class="nav-link">
  🔥SpringCloud Alibaba实战
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/middleware/rpc/2022-08-24-我设计了一款TPS百万级别的RPC框架.html" class="nav-link">
  🔥《RPC手撸专栏》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/bytecode/2022-04-11-001-工作多年的你依然重复做着CRUD-是否接触过这种技术.html" class="nav-link">
  《字节码编程》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/threadpool/default.html" class="nav-link">
  《手写线程池》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/limiter/default.html" class="nav-link">
  《分布式限流》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/independent/default.html" class="nav-link">
  《开源项目》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="渗透技术" class="dropdown-title"><span class="title">渗透技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/hack/log4j/2022-05-30-冰河连夜复现了Log4j最新重大漏洞.html" class="nav-link">
  log4j重大漏洞
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/environment/2022-04-17-001-安装Kali系统.html" class="nav-link">
  基础环境篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/tools/2022-04-17-001-使用Easy-Creds工具攻击无线网络.html" class="nav-link">
  渗透工具篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/horse/2022-05-02-001-各种一句话木马大全.html" class="nav-link">
  木马篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/sql/2022-05-02-001-sqli-labs-master下载与安装.html" class="nav-link">
  SQL注入篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/shell/2022-05-02-001-各种解析漏洞拿shell.html" class="nav-link">
  漏洞拿Shell篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/crack/2022-05-02-001-使用rarcrack暴力破解RAR-ZIP-7Z压缩包.html" class="nav-link">
  暴力破解篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/bash/2022-05-02-001-3389脚本开启代码(vbs版).html" class="nav-link">
  渗透脚本篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/raising/2022-05-02-001-数据库提权.html" class="nav-link">
  数据与系统提权篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/client/2022-05-02-001-浏览器渗透.html" class="nav-link">
  客户端渗透篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/sociology/2022-05-02-001-Metasploit之社会工程学工具包.html" class="nav-link">
  社会工程学
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/question/2022-05-02-001-HTTP错误4031禁止访问-执行访问被拒绝.html" class="nav-link">
  问题记录篇
</a></li></ul></div></div><div class="nav-item"><a href="/md/starball/2022-12-24-硬核星球-即将涨价.html" class="nav-link">
  🌍知识星球
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="📚书籍" class="dropdown-title"><span class="title">📚书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          出版图书
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-06-17-深入理解高并发编程.html" class="nav-link">
  《深入理解高并发编程：核心原理与案例实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-深入理解分布式事务.html" class="nav-link">
  《深入理解分布式事务：原理与实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-MySQL技术大全.html" class="nav-link">
  《MySQL技术大全：开发、优化与运维实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-海量数据处理与大数据技术实战.html" class="nav-link">
  《海量数据处理与大数据技术实战》
</a></li></ul></li><li class="dropdown-item"><h4>
          电子书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-10-31《深入理解高并发编程（第2版）》打包发布.html" class="nav-link">
  《深入理解高并发编程(第2版)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-07-25-深入理解高并发编程-第1版.html" class="nav-link">
  《深入理解高并发编程(第1版)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-12-05-《从零开始手写RPC框架》电子书发布.html" class="nav-link">
  《从零开始手写RPC框架(基础篇)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-07-25-十大篇章-共26个章节-332页-打包发布.html" class="nav-link">
  《SpringCloud Alibaba实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-03-30-《冰河的渗透实战笔记》电子书，442页，37万字，正式发布.html" class="nav-link">
  《冰河的渗透实战笔记》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-11-14-《MySQL核心知识手册》-打包发布.html" class="nav-link">
  《MySQL核心知识手册》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/about/me/about-me.html" class="nav-link">
  关于自己
</a></li><li class="dropdown-item"><!----> <a href="/md/about/study/default.html" class="nav-link">
  关于学习
</a></li><li class="dropdown-item"><!----> <a href="/md/about/job/default.html" class="nav-link">
  关于职场
</a></li></ul></div></div><div class="nav-item"><a href="https://space.bilibili.com/517638832" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/binghe001/BingheGuide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/md/all/all.html" class="nav-link">
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="核心技术" class="dropdown-title"><span class="title">核心技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          面试必问系列
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/interview/2022-04-18-001-面试必问-聊聊JVM性能调优.html" class="nav-link">
  面试必问
</a></li></ul></li><li class="dropdown-item"><h4>
          Java核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/java/basics/2022-04-28-全网最全正则表达式总结.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-subitem"><a href="/md/core/java/advanced/default.html" class="nav-link">
  Java进阶
</a></li><li class="dropdown-subitem"><a href="/md/core/java/senior/default.html" class="nav-link">
  Java高级
</a></li><li class="dropdown-subitem"><a href="/md/core/java/java8/2022-03-31-001-Java8有哪些新特性呢？.html" class="nav-link">
  Java8新特性
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/spring/ioc/2022-04-04-001-聊聊Spring注解驱动开发那些事儿.html" class="nav-link">
  IOC核心技术
</a></li><li class="dropdown-subitem"><a href="/md/core/spring/aop/default.html" class="nav-link">
  AOP核心技术
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/jvm/2022-04-18-001-JVM调优的几种场景.html" class="nav-link">
  JVM调优技术
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL核心技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/core/mysql/base/2022-08-25-MySQL索引底层技术.html" class="nav-link">
  MySQL基础篇
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="性能调优" class="dropdown-title"><span class="title">性能调优</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/performance/jvm/default.html" class="nav-link">
  JVM性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/tomcat/default.html" class="nav-link">
  Tomcat性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/mysql/default.html" class="nav-link">
  MySQL性能调优
</a></li><li class="dropdown-item"><!----> <a href="/md/performance/system/default.html" class="nav-link">
  操作系统性能调优
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="并发编程" class="dropdown-title"><span class="title">并发编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/concurrent/bottom/default.html" class="nav-link">
  底层技术
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/source/2020-03-30-001-一文搞懂线程与多线程.html" class="nav-link">
  源码分析
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/basics/2020-03-30-001-明明中断了线程，却为何不起作用呢？.html" class="nav-link">
  基础案例
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/ActualCombat/default.html" class="nav-link">
  实战案例
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/interview/default.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/md/concurrent/framework/default.html" class="nav-link">
  系统架构
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥框架源码" class="dropdown-title"><span class="title">🔥框架源码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/frame/spring/ioc/2022-12-02-《Spring核心技术》开篇-我要带你一步步调试Spring6.0源码啦.html" class="nav-link">
  🔥Spring核心技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分布式" class="dropdown-title"><span class="title">分布式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          缓存技术
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/cache/default.html" class="nav-link">
  Redis
</a></li></ul></li><li class="dropdown-item"><h4>
          服务注册发现
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/zookeeper/default.html" class="nav-link">
  Zookeeper
</a></li></ul></li><li class="dropdown-item"><h4>
          消息中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/mq/rabbitmq/default.html" class="nav-link">
  RabbitMQ
</a></li><li class="dropdown-subitem"><a href="/md/distributed/mq/rocketmq/default.html" class="nav-link">
  RocketMQ
</a></li><li class="dropdown-subitem"><a href="/md/distributed/mq/kafka/default.html" class="nav-link">
  Kafka
</a></li></ul></li><li class="dropdown-item"><h4>
          网络通信
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/netty/default.html" class="nav-link">
  Netty
</a></li></ul></li><li class="dropdown-item"><h4>
          远程调用
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/dubbo/default.html" class="nav-link">
  Dubbo
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/mongodb/default.html" class="nav-link">
  MongoDB
</a></li></ul></li><li class="dropdown-item"><h4>
          搜索引擎
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/distributed/es/default.html" class="nav-link">
  ElasticSearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥微服务" class="dropdown-title"><span class="title">🔥微服务</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/microservices/springboot/default.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/md/microservices/springcloudalibaba/2022-04-02-SpringCloudAlibaba专栏开篇.html" class="nav-link">
  🔥SpringCloudAlibaba
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🔥项目实战" class="dropdown-title"><span class="title">🔥项目实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          微服务项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/microservices/springcloudalibaba/2022-04-02-SpringCloudAlibaba专栏开篇.html" class="nav-link">
  🔥SpringCloud Alibaba实战
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/middleware/rpc/2022-08-24-我设计了一款TPS百万级别的RPC框架.html" class="nav-link">
  🔥《RPC手撸专栏》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/bytecode/2022-04-11-001-工作多年的你依然重复做着CRUD-是否接触过这种技术.html" class="nav-link">
  《字节码编程》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/threadpool/default.html" class="nav-link">
  《手写线程池》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/limiter/default.html" class="nav-link">
  《分布式限流》
</a></li><li class="dropdown-subitem"><a href="/md/middleware/independent/default.html" class="nav-link">
  《开源项目》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="渗透技术" class="dropdown-title"><span class="title">渗透技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/hack/log4j/2022-05-30-冰河连夜复现了Log4j最新重大漏洞.html" class="nav-link">
  log4j重大漏洞
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/environment/2022-04-17-001-安装Kali系统.html" class="nav-link">
  基础环境篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/tools/2022-04-17-001-使用Easy-Creds工具攻击无线网络.html" class="nav-link">
  渗透工具篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/horse/2022-05-02-001-各种一句话木马大全.html" class="nav-link">
  木马篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/sql/2022-05-02-001-sqli-labs-master下载与安装.html" class="nav-link">
  SQL注入篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/shell/2022-05-02-001-各种解析漏洞拿shell.html" class="nav-link">
  漏洞拿Shell篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/crack/2022-05-02-001-使用rarcrack暴力破解RAR-ZIP-7Z压缩包.html" class="nav-link">
  暴力破解篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/bash/2022-05-02-001-3389脚本开启代码(vbs版).html" class="nav-link">
  渗透脚本篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/raising/2022-05-02-001-数据库提权.html" class="nav-link">
  数据与系统提权篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/client/2022-05-02-001-浏览器渗透.html" class="nav-link">
  客户端渗透篇
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/sociology/2022-05-02-001-Metasploit之社会工程学工具包.html" class="nav-link">
  社会工程学
</a></li><li class="dropdown-item"><!----> <a href="/md/hack/question/2022-05-02-001-HTTP错误4031禁止访问-执行访问被拒绝.html" class="nav-link">
  问题记录篇
</a></li></ul></div></div><div class="nav-item"><a href="/md/starball/2022-12-24-硬核星球-即将涨价.html" class="nav-link">
  🌍知识星球
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="📚书籍" class="dropdown-title"><span class="title">📚书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          出版图书
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-06-17-深入理解高并发编程.html" class="nav-link">
  《深入理解高并发编程：核心原理与案例实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-深入理解分布式事务.html" class="nav-link">
  《深入理解分布式事务：原理与实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-MySQL技术大全.html" class="nav-link">
  《MySQL技术大全：开发、优化与运维实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/book/2022-03-29-海量数据处理与大数据技术实战.html" class="nav-link">
  《海量数据处理与大数据技术实战》
</a></li></ul></li><li class="dropdown-item"><h4>
          电子书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-10-31《深入理解高并发编程（第2版）》打包发布.html" class="nav-link">
  《深入理解高并发编程(第2版)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-07-25-深入理解高并发编程-第1版.html" class="nav-link">
  《深入理解高并发编程(第1版)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-12-05-《从零开始手写RPC框架》电子书发布.html" class="nav-link">
  《从零开始手写RPC框架(基础篇)》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-07-25-十大篇章-共26个章节-332页-打包发布.html" class="nav-link">
  《SpringCloud Alibaba实战》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-03-30-《冰河的渗透实战笔记》电子书，442页，37万字，正式发布.html" class="nav-link">
  《冰河的渗透实战笔记》
</a></li><li class="dropdown-subitem"><a href="/md/knowledge/pdf/2022-11-14-《MySQL核心知识手册》-打包发布.html" class="nav-link">
  《MySQL核心知识手册》
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/about/me/about-me.html" class="nav-link">
  关于自己
</a></li><li class="dropdown-item"><!----> <a href="/md/about/study/default.html" class="nav-link">
  关于学习
</a></li><li class="dropdown-item"><!----> <a href="/md/about/job/default.html" class="nav-link">
  关于职场
</a></li></ul></div></div><div class="nav-item"><a href="https://space.bilibili.com/517638832" target="_blank" rel="noopener noreferrer" class="nav-link external">
  B站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/binghe001/BingheGuide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/core/mysql/base/2022-08-25-MySQL索引底层技术.html" class="sidebar-link">【置顶】MySQL索引底层技术</a></li><li><a href="/md/core/mysql/base/2022-08-25-MySQL之MVCC实现原理.html" class="sidebar-link">【置顶】MySQL之MVCC实现原理</a></li><li><a href="/md/core/mysql/base/2022-07-09-《MySQL核心知识》第1章-开篇-专栏介绍.html" class="sidebar-link">第1章：开篇：专栏介绍</a></li><li><a href="/md/core/mysql/base/2022-07-11-《MySQL核心知识》第2章-MySQL常用的命令.html" class="sidebar-link">第2章：MySQL常用的命令</a></li><li><a href="/md/core/mysql/base/2022-07-13-《MySQL核心知识》第3章-MySQL中的运算符.html" class="sidebar-link">第3章：MySQL中的运算符</a></li><li><a href="/md/core/mysql/base/2022-07-18-《MySQL核心知识》第4章-简单语法.html" class="sidebar-link">第4章：简单语法</a></li><li><a href="/md/core/mysql/base/2022-07-25-《MySQL核心知识》第5章-查看字段长度与类型宽度.html" class="sidebar-link">第5章：查看字段长度与类型宽度</a></li><li><a href="/md/core/mysql/base/2022-08-01-《MySQL核心知识》第6章-查询语句.html" class="sidebar-link">第6章：查询语句</a></li><li><a href="/md/core/mysql/base/2022-08-07-《MySQL核心知识》第7章-插入-更新-删除.html" class="sidebar-link">第7章：插入、更新、删除</a></li><li><a href="/md/core/mysql/base/2022-08-15-《MySQL核心知识》第8章-索引.html" class="sidebar-link">第8章：索引</a></li><li><a href="/md/core/mysql/base/2022-08-22-《MySQL核心知识》第9章-函数.html" class="sidebar-link">第9章：函数</a></li><li><a href="/md/core/mysql/base/2022-08-29-《MySQL核心知识》第10章：自定义存储过程和函数.html" class="active sidebar-link">第10章：自定义存储过程和函数</a></li><li><a href="/md/core/mysql/base/2022-09-16-《MySQL核心知识》第11章：视图.html" class="sidebar-link">第11章：视图</a></li><li><a href="/md/core/mysql/base/2022-09-19-《MySQL核心知识》第12章：触发器.html" class="sidebar-link">第12章：触发器</a></li><li><a href="/md/core/mysql/base/2022-09-26-《MySQL核心知识》第13章：权限管理.html" class="sidebar-link">第13章：权限管理</a></li><li><a href="/md/core/mysql/base/2022-09-28-《MySQL核心知识》第14章：数据备份与恢复.html" class="sidebar-link">第14章：数据备份与恢复</a></li><li><a href="/md/core/mysql/base/2022-10-18-《MySQL核心知识》第15章-自动备份与恢复MySQL数据库并发送Email邮件.html" class="sidebar-link">第15章：自动备份与恢复MySQL数据库并发送Email邮件</a></li><li><a href="/md/core/mysql/base/2022-10-24-《MySQL核心知识》第16章-日志.html" class="sidebar-link">第16章：MySQL中的日志</a></li><li><a href="/md/core/mysql/base/2022-10-31-《MySQL核心知识》第17章-性能优化.html" class="sidebar-link">第17章：性能优化</a></li><li><a href="/md/core/mysql/base/2022-11-06-《MySQL核心知识》第18章-复制.html" class="sidebar-link">第18章：复制</a></li><li><a href="/md/core/mysql/base/2022-11-09-《MySQL核心知识》第19章-安全地关闭MySQL实例.html" class="sidebar-link">第19章：安全地关闭MySQL实例</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="《mysql核心知识》第10章-自定义存储过程和函数"><a href="#《mysql核心知识》第10章-自定义存储过程和函数" class="header-anchor">#</a> 《MySQL核心知识》第10章：自定义存储过程和函数</h1> <p><strong>大家好，我是冰河~~</strong></p> <p>今天是《MySQL核心知识》专栏的第10章，今天为大家系统的讲讲MySQL中如何自定义存储过程和函数，希望通过本章节的学习，小伙伴们能够举一反三，彻底掌握MySQL中关于自定义存储过程和函数的知识。好了，开始今天的正题吧。</p> <p>MySQL中创建存储过程和函数分别使用<code>CREATE PROCEDURE</code>和<code>CREATE FUNCTION</code>，使用CALL语句来调用存储过程，存储过程也可以调用其他存储过程。函数可以从语句外调用，能返回标量值。</p> <h2 id="创建存储过程"><a href="#创建存储过程" class="header-anchor">#</a> 创建存储过程</h2> <p>语法</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> sp_name <span class="token punctuation">(</span><span class="token punctuation">[</span> proc_parameter <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> characteristics<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> routine_body 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>proc_parameter指定存储过程的参数列表，列表形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">OUT</span><span class="token operator">|</span><span class="token keyword">INOUT</span><span class="token punctuation">]</span> param_name <span class="token keyword">type</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中in表示输入参数，out表示输出参数，inout表示既可以输入也可以输出；param_name表示参数名称；type表示参数的类型</p> <p>该类型可以是MySQL数据库中的任意类型。</p> <p>有以下取值：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>characteristic: 
    <span class="token keyword">LANGUAGE</span> <span class="token keyword">SQL</span> 
  <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token operator">NOT</span><span class="token punctuation">]</span> <span class="token keyword">DETERMINISTIC</span> 
  <span class="token operator">|</span> { <span class="token keyword">CONTAINS</span> <span class="token keyword">SQL</span> <span class="token operator">|</span> <span class="token keyword">NO</span> <span class="token keyword">SQL</span> <span class="token operator">|</span> <span class="token keyword">READS</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span> <span class="token operator">|</span> <span class="token keyword">MODIFIES</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span> } 
  <span class="token operator">|</span> <span class="token keyword">SQL</span> SECURITY { <span class="token keyword">DEFINER</span> <span class="token operator">|</span> <span class="token keyword">INVOKER</span> } 
  <span class="token operator">|</span> <span class="token keyword">COMMENT</span> <span class="token string">'string'</span> 
routine_body: 
    Valid <span class="token keyword">SQL</span> <span class="token keyword">procedure</span> statement <span class="token operator">or</span> statements
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>（1）LANGUAGE SQL ：说明routine_body部分是由SQL语句组成的，当前系统支持的语言为SQL，SQL是LANGUAGE特性的唯一值</p> <p>（2）[NOT] DETERMINISTIC ：指明存储过程执行的结果是否正确。DETERMINISTIC 表示结果是确定的。每次执行存储过程时，相同的输入会得到相同的输出。[NOT] DETERMINISTIC 表示结果是不确定的，相同的输入可能得到不同的输出。如果没有指定任意一个值，默认为[NOT] ETERMINISTIC</p> <p>（3）CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA：指明子程序使用SQL语句的限制。</p> <ul><li>CONTAINS SQL表明子程序包含SQL语句，但是不包含读写数据的语句；</li> <li>NO SQL表明子程序不包含SQL语句；</li> <li>READS SQL DATA：说明子程序包含读数据的语句；</li> <li>MODIFIES SQL DATA表明子程序包含写数据的语句。</li></ul> <p>默认情况下，系统会指定为CONTAINS SQL</p> <p>（4）SQL SECURITY { DEFINER | INVOKER } ：指明谁有权限来执行。DEFINER 表示只有定义者才能执行</p> <ul><li>INVOKER 表示拥有权限的调用者可以执行。默认情况下，系统指定为DEFINER</li></ul> <p>（5）COMMENT 'string' ：注释信息，可以用来描述存储过程或函数</p> <p>（6）routine_body是SQL代码的内容，可以用BEGIN...END来表示SQL代码的开始和结束。</p> <p>下面的语句创建一个查询t1表全部数据的存储过程</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">Proc</span><span class="token punctuation">;</span> 
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token keyword">BEGIN</span>
  <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t3<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token keyword">CALL</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/4fe32dfc5e36bec66ad1a95757d81213.jpeg" loading="lazy" class="lazy"></p> <p>这里的逻辑是：</p> <p>1、先判断是否有Proc() 这个存储过程，有就drop掉</p> <p>2、创建Proc() 存储过程</p> <p>3、执行Proc() 存储过程</p> <blockquote><p><strong>注意：“DELIMITER //”语句的作用是将MySQL的结束符设置为//，因为MySQL默认的语句结束符为分号;，为了避免与存储过程</strong></p> <p><strong>中SQL语句结束符相冲突，需要使用DELIMITER 改变存储过程的结束符，并以“END//”结束存储过程。</strong></p> <p><strong>存储过程定义完毕之后再使用DELIMITER ;恢复默认结束符。DELIMITER 也可以指定其他符号为结束符！！！！！！！！！</strong></p></blockquote> <p>如果你是这样写的话，就会得到如下错误，初学者很容易犯这个错误.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token keyword">BEGIN</span>
  <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t3<span class="token punctuation">;</span>
<span class="token keyword">END</span>

Query: <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">BEGIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t3

Error Code: <span class="token number">1064</span>
You have an error <span class="token operator">in</span> your <span class="token keyword">SQL</span> syntax<span class="token punctuation">;</span> <span class="token keyword">check</span> the manual that corresponds <span class="token keyword">to</span> your MySQL server version <span class="token keyword">for</span> the <span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">''</span> at line <span class="token number">3</span>

Execution <span class="token keyword">Time</span> : <span class="token number">0</span> sec
Transfer <span class="token keyword">Time</span>  : <span class="token number">0</span> sec
Total <span class="token keyword">Time</span>     : <span class="token number">0.001</span> sec
<span class="token comment">---------------------------------------------------</span>
Query: <span class="token keyword">END</span> 

Error Code: <span class="token number">1064</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>创建名为CountProc的存储过程，代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> CountProc<span class="token punctuation">;</span> 
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> CountProc<span class="token punctuation">(</span><span class="token keyword">OUT</span> param1 <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">SELECT</span>    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span>  param1 <span class="token keyword">FROM</span> s_visit_log<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token keyword">CALL</span> CountProc<span class="token punctuation">(</span><span class="token variable">@aaa</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@aaa</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>上面代码的作用是创建一个获取t3表记录数的存储过程，名称是CountProc，</p> <p>COUNT(*)计算后把结果放入参数param1中。</p> <p><strong>注意：当使用DELIMITER命令时，应该避免使用反斜杠（\）字符，因为反斜杠是MySQL的转义字符！！！</strong></p> <h2 id="存储函数"><a href="#存储函数" class="header-anchor">#</a> 存储函数</h2> <p>创建存储函数，需要使用CREATE FUNCTION语句，基本语法如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> func_name<span class="token punctuation">(</span><span class="token punctuation">[</span>func_parameter<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">TYPE</span>
<span class="token punctuation">[</span>characteristics<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> routine_body
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>CREATE FUNCTION为用来创建存储函数的关键字；func_name表示存储函数的名称</p> <p>func_parameter为存储函数的参数列表，参数列表如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">OUT</span><span class="token operator">|</span><span class="token keyword">INOUT</span><span class="token punctuation">]</span>PARAM_NAMETYPE
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，IN表示输入参数，OUT表示输出参数，INOUT表示既可以输入也可以输出；</p> <p>param_name表示参数名称；type表示参数类型，该类型可以是MySQL数据库中的任意类型</p> <p>RETURNS TYPE语句表示函数返回数据的类型；characteristics：指定存储函数的特性，取值与创建存储过程时相同</p> <p>创建存储函数，名称为NameByT，该函数返回SELECT语句的查询结果，数值类型为字符串型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELIMITER</span> <span class="token comment">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> NameByT<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> NAME <span class="token keyword">FROM</span> t3 <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p><strong>注意：RETURNS CHAR(50)数据类型的时候，RETURNS 是有S的，而RETURN (SELECT NAME FROM t3 WHERE id=2)的时候RETURN是没有S的</strong></p> <p><strong>所以有时候大家可能觉得MySQL很烦，谁不知是自己写错了</strong></p> <p><strong>这里有一个方法，就是利用SQLYOG的代码格式化功能，选中要格式化的代码，然后按F12，如果能格式化，证明你的代码没有问题，如果不能格式化</strong></p> <p><strong>证明你写的代码有问题！！！</strong></p></blockquote> <p>不加s的话就会出现语法错误了</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>Query: <span class="token keyword">create</span> <span class="token keyword">function</span> NameByT<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">select</span> name <span class="token keyword">from</span> t3 <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

Error Code: <span class="token number">1064</span>
You have an error <span class="token operator">in</span> your <span class="token keyword">SQL</span> syntax<span class="token punctuation">;</span> <span class="token keyword">check</span> the manual that corresponds <span class="token keyword">to</span> your MySQL server version <span class="token keyword">for</span> the <span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">'return char(50)
return (select name from t3 where id=2)'</span> at line <span class="token number">2</span>

Execution <span class="token keyword">Time</span> : <span class="token number">0</span> sec
Transfer <span class="token keyword">Time</span>  : <span class="token number">0</span> sec
Total <span class="token keyword">Time</span>     : <span class="token number">0.003</span> sec
<span class="token comment">-----------------------------</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>调用函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> nameByT<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/bb9160848e69650492282df86f6d21ec.jpeg" loading="lazy" class="lazy"></p> <p>如果在存储函数中的RETURN语句返回一个类型不同于函数的RETURNS子句中指定类型的值，返回值将被强制转换为恰当的类型。</p> <p>例如，如果一个函数返回一个SET或ENUM值，但是RETURN语句返回一个整数，对于SET成员集的相应ENUM成员，从函数返回的值</p> <p>是字符串。</p> <blockquote><p>指定参数为IN、OUT、INOUT只对PROCEDURE是合法的。</p> <p>（FUNCTION中总是默认是IN参数）RETURNS子句对FUNCTION做指定，对函数而言这是强制的。</p> <p>他用来指定函数的返回类型，而且函数体必须包含一个RETURN value语句</p></blockquote> <h2 id="变量的使用"><a href="#变量的使用" class="header-anchor">#</a> 变量的使用</h2> <p>变量可以在子程序中声明并使用，这些变量的作用范围是在BEGIN...END程序中</p> <p>1、定义变量</p> <p>在存储过程中定义变量</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> var_name<span class="token punctuation">[</span><span class="token punctuation">,</span>varname<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>date_type<span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> <span class="token keyword">VALUE</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>var_name为局部变量的名称。DEFAULT VALUE子句给变量提供一个默认值。值除了可以被声明为一个常数外，还可以被指定为一个表达式。</p> <p>如果没有DEFAULT子句，初始值为NULL</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> MYPARAM <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、为变量赋值</p> <p>定义变量之后，为变量赋值可以改变变量的默认值，MySQL中使用SET语句为变量赋值</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> var_name<span class="token operator">=</span>expr<span class="token punctuation">[</span><span class="token punctuation">,</span>var_name<span class="token operator">=</span>expr<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在存储过程中的SET语句是一般SET语句的扩展版本。</p> <p>被SET的变量可能是子程序内的变量，或者是全局服务器变量，如系统变量或者用户变量</p> <p>运行SET a=x,b=y,....</p> <p>声明3个变量，分别为var1，var2和var3</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> var1<span class="token punctuation">,</span>var2<span class="token punctuation">,</span>var3 <span class="token keyword">INT</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> var1<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>var2<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> var3<span class="token operator">=</span>var1<span class="token operator">+</span>var2<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>MySQL中还可以通过SELECT...INTO为一个或多个变量赋值</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> NAME <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">DECLARE</span> id <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>NAME <span class="token keyword">INTO</span> id <span class="token punctuation">,</span>NAME <span class="token keyword">FROM</span> t3 <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="定义条件和处理程序"><a href="#定义条件和处理程序" class="header-anchor">#</a> 定义条件和处理程序</h2> <p>特定条件需要特定处理。这些条件可以联系到错误，以及子程序中的一般流程控制。定义条件是事先定义程序执行过程中遇到的问题，</p> <p>处理程序定义了在遇到这些问题时候应当采取的处理方式，并且保证存储过程或函数在遇到警告或错误时能继续执行。</p> <p>这样可以增强存储程序处理问题的能力，避免程序异常停止运行</p> <p>1、定义条件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> condition_name CONDITION <span class="token keyword">FOR</span><span class="token punctuation">[</span>condition_type<span class="token punctuation">]</span>
<span class="token punctuation">[</span>condition_type<span class="token punctuation">]</span>:
SQLSTATE<span class="token punctuation">[</span><span class="token keyword">VALUE</span><span class="token punctuation">]</span> sqlstate_value <span class="token operator">|</span>MySQL_error_code
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>condition_name：表示条件名称</li> <li>condition_type：表示条件的类型</li> <li>sqlstate_value和MySQL_error_code都可以表示MySQL错误</li> <li>sqlstate_value为长度5的字符串错误代码</li> <li>MySQL_error_code为数值类型错误代码，例如：ERROR1142(42000)中，sqlstate_value的值是42000，MySQL_error_code的值是1142</li></ul> <p>这个语句指定需要特殊处理条件。他将一个名字和指定的错误条件关联起来。</p> <p>这个名字随后被用在定义处理程序的DECLARE HANDLER语句中</p> <p>定义ERROR1148(42000)错误，名称为command_not_allowed。</p> <p>可以用两种方法定义</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">//方法一：使用sqlstate_value</span>
<span class="token keyword">DECLARE</span> command_not_allowed CONDITION <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'42000'</span>

<span class="token comment">//方法二：使用MySQL_error_code</span>
<span class="token keyword">DECLARE</span> command_not_allowed CONDITION <span class="token keyword">FOR</span> SQLSTATE <span class="token number">1148</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2．定义处理程序</p> <p>MySQL中可以使用DECLARE关键字来定义处理程序。其基本语法如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> handler_type <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> 
condition_value<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> sp_statement 
handler_type: 
<span class="token keyword">CONTINUE</span> <span class="token operator">|</span> <span class="token keyword">EXIT</span> <span class="token operator">|</span> UNDO 
condition_value: 
SQLSTATE <span class="token punctuation">[</span><span class="token keyword">VALUE</span><span class="token punctuation">]</span> sqlstate_value <span class="token operator">|</span>
condition_name <span class="token operator">|</span> SQLWARNING 
<span class="token operator">|</span> <span class="token operator">NOT</span> FOUND <span class="token operator">|</span> SQLEXCEPTION <span class="token operator">|</span> MySQL_error_code 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>其中，handler_type参数指明错误的处理方式，该参数有3个取值。这3个取值分别是CONTINUE、EXIT和UNDO。</p> <p>CONTINUE表示遇到错误不进行处理，继续向下执行；</p> <p>EXIT表示遇到错误后马上退出；</p> <p>UNDO表示遇到错误后撤回之前的操作，MySQL中暂时还不支持这种处理方式。</p> <p>注意：通常情况下，执行过程中遇到错误应该立刻停止执行下面的语句，并且撤回前面的操作。</p> <p>但是，MySQL中现在还不能支持UNDO操作。</p> <p>因此，遇到错误时最好执行EXIT操作。如果事先能够预测错误类型，并且进行相应的处理，那么可以执行CONTINUE操作。</p> <p>condition_value参数指明错误类型，该参数有6个取值。</p> <p>sqlstate_value和MySQL_error_code与条件定义中的是同一个意思。</p> <p>condition_name是DECLARE定义的条件名称。</p> <p>SQLWARNING表示所有以01开头的sqlstate_value值。</p> <p>NOT FOUND表示所有以02开头的sqlstate_value值。</p> <p>SQLEXCEPTION表示所有没有被SQLWARNING或NOT FOUND捕获的sqlstate_value值。</p> <p>sp_statement表示一些存储过程或函数的执行语句。</p> <p>下面是定义处理程序的几种方式。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">//方法一：捕获sqlstate_value </span>
<span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'42000'</span>
<span class="token keyword">SET</span> <span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'CAN NOT FIND'</span><span class="token punctuation">;</span> 
<span class="token comment">//方法二：捕获MySQL_error_code </span>
<span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> <span class="token number">1148</span>SET <span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'CAN NOT FIND'</span><span class="token punctuation">;</span> 
<span class="token comment">//方法三：先定义条件，然后调用 </span>
<span class="token keyword">DECLARE</span> can_not_find CONDITION <span class="token keyword">FOR</span> <span class="token number">1146</span> <span class="token punctuation">;</span> 
<span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> can_not_find <span class="token keyword">SET</span> 
<span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'CAN NOT FIND'</span><span class="token punctuation">;</span> 
<span class="token comment">//方法四：使用SQLWARNING </span>
<span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLWARNING <span class="token keyword">SET</span> <span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'ERROR'</span><span class="token punctuation">;</span> 
<span class="token comment">//方法五：使用NOT FOUND </span>
<span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> <span class="token operator">NOT</span> FOUND <span class="token keyword">SET</span> <span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'CAN NOT FIND'</span><span class="token punctuation">;</span> 
<span class="token comment">//方法六：使用SQLEXCEPTION </span>
<span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLEXCEPTION <span class="token keyword">SET</span> <span class="token variable">@info</span><span class="token operator">=</span><span class="token string">'ERROR'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>上述代码是6种定义处理程序的方法。</p> <p>第一种方法是捕获sqlstate_value值。如果遇到sqlstate_value值为42000，执行CONTINUE操作，并且输出&quot;CAN NOT FIND&quot;信息。</p> <p>第二种方法是捕获MySQL_error_code值。如果遇到MySQL_error_code值为1148，执行CONTINUE操作，并且输出&quot;CAN NOT FIND&quot;信息。</p> <p>第三种方法是先定义条件，然后再调用条件。这里先定义can_not_find条件，遇到1148错误就执行CONTINUE操作。</p> <p>第四种方法是使用SQLWARNING。SQLWARNING捕获所有以01开头的sqlstate_value值，然后执行EXIT操作，并且输出&quot;ERROR&quot;信息。</p> <p>第五种方法是使用NOT FOUND。NOT FOUND捕获所有以02开头的sqlstate_value值，然后执行EXIT操作，并且输出&quot;CAN NOT FIND&quot;信息。</p> <p>第六种方法是使用SQLEXCEPTION。SQLEXCEPTION捕获所有没有被SQLWARNING或NOT FOUND捕获的sqlstate_value值，然后执行EXIT操作，并且输出&quot;ERROR&quot;信息</p> <p>定义条件和处理程序</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t8<span class="token punctuation">(</span>s1 <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> handlerdemo<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'23000'</span> <span class="token keyword">SET</span> <span class="token variable">@X2</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@X</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t8 <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@X</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t8 <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@X</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">/* 调用存储过程*/</span>
<span class="token keyword">CALL</span> handlerdemo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* 查看调用存储过程结果*/</span>
<span class="token keyword">SELECT</span> <span class="token variable">@X</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/f6e7c362b3c52a838ee5170322eef897.jpeg" loading="lazy" class="lazy"></p> <p>@X是一个用户变量，执行结果@X等于3，这表明MySQL执行到程序的末尾。</p> <p>如果DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @X2=1;，这一行不存在</p> <p>第二个INSERT因PRIMARY KEY约束而失败之后，MySQL可能已经采取EXIT策略，并且SELECT @X可能已经返回2</p> <p>注意：@X表示用户变量，使用SET语句为其赋值，用户变量与连接有关，一个客户端定义的变量不能被其他客户端所使用</p> <p>即有作用域的，该客户端退出时，客户端连接的所有变量将自动释放</p> <p>这里的变量跟SQLSERVER没有什么区别，都是用来存储临时值的</p> <h2 id="光标"><a href="#光标" class="header-anchor">#</a> 光标</h2> <p>MySQL里叫光标，SQLSERVER里叫游标，实际上一样的</p> <p>查询语句可能查询出多条记录，在存储过程和函数中使用光标来逐条读取查询结果集中的记录。</p> <p>光标的使用包括声明光标、打开光标、使用光标和关闭光标。光标必须声明在处理程序之前，并且声明在变量和条件之后。</p> <p><strong>1．声明光标</strong></p> <p>MySQL中使用DECLARE关键字来声明光标。其语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> cursor_name <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> select_statement <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，cursor_name参数表示光标的名称；select_statement参数表示SELECT语句的内容，返回一个用于创建光标的结果集</p> <p>下面声明一个名为cur_employee的光标。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> cur_employee <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> <span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> age <span class="token keyword">FROM</span> employee <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的示例中，光标的名称为cur_employee；SELECT语句部分是从employee表中查询出name和age字段的值。</p> <p><strong>2．打开光标</strong></p> <p>MySQL中使用OPEN关键字来打开光标。其语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">OPEN</span>  cursor_name <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，cursor_name参数表示光标的名称。</p> <p>下面打开一个名为cur_employee的光标，代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">OPEN</span>  cur_employee <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>3．使用光标</strong></p> <p>MySQL中使用FETCH关键字来使用光标。其语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">FETCH</span> cur_employee <span class="token keyword">INTO</span> var_name<span class="token punctuation">[</span><span class="token punctuation">,</span>var_name…<span class="token punctuation">]</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，cursor_name参数表示光标的名称；var_name参数表示将光标中的SELECT语句查询出来的信息存入该参数中。var_name必须在声明光标之前就定义好。</p> <p>下面使用一个名为cur_employee的光标。将查询出来的数据存入emp_name和emp_age这两个变量中，代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">FETCH</span>  cur_employee <span class="token keyword">INTO</span> emp_name<span class="token punctuation">,</span> emp_age <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的示例中，将光标cur_employee中SELECT语句查询出来的信息存入emp_name和emp_age中。emp_name和emp_age必须在前面已经定义。</p> <p><strong>4．关闭光标</strong></p> <p>MySQL中使用CLOSE关键字来关闭光标。其语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CLOSE</span>  cursor_name <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，cursor_name参数表示光标的名称。</p> <p>【示例】 下面关闭一个名为cur_employee的光标。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CLOSE</span>  cur_employee <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的示例中，关闭了这个名称为cur_employee的光标。关闭之后就不能使用FETCH来使用光标了。</p> <blockquote><p><strong>注意：MySQL中，光标只能在存储过程和函数中使用！！</strong></p></blockquote> <h2 id="流程控制的使用"><a href="#流程控制的使用" class="header-anchor">#</a> 流程控制的使用</h2> <p>存储过程和函数中可以使用流程控制来控制语句的执行。</p> <p>MySQL中可以使用IF语句、CASE语句、LOOP语句、LEAVE语句、ITERATE语句、REPEAT语句和WHILE语句来进行流程控制。</p> <p>每个流程中可能包含一个单独语句，或者是使用BEGIN...END构造的复合语句，构造可以被嵌套</p> <p>1．IF语句</p> <p>IF语句用来进行条件判断。根据是否满足条件，将执行不同的语句。其语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">IF</span> search_condition <span class="token keyword">THEN</span> statement_list 
<span class="token punctuation">[</span><span class="token keyword">ELSEIF</span> search_condition <span class="token keyword">THEN</span> statement_list<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token punctuation">[</span><span class="token keyword">ELSE</span> statement_list<span class="token punctuation">]</span> 
<span class="token keyword">END</span> <span class="token keyword">IF</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中，search_condition参数表示条件判断语句；statement_list参数表示不同条件的执行语句。</p> <p>注意：MySQL还有一个IF()函数，不同于这里描述的IF语句</p> <p>下面是一个IF语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">IF</span> age<span class="token operator">&gt;</span><span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> <span class="token variable">@count1</span><span class="token operator">=</span><span class="token variable">@count1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token keyword">ELSEIF</span> age<span class="token operator">=</span><span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> <span class="token variable">@count2</span><span class="token operator">=</span><span class="token variable">@count2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token keyword">ELSE</span> <span class="token keyword">SET</span> <span class="token variable">@count3</span><span class="token operator">=</span><span class="token variable">@count3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>该示例根据age与20的大小关系来执行不同的SET语句。</p> <p>如果age值大于20，那么将count1的值加1；如果age值等于20，那么将count2的值加1；</p> <p>其他情况将count3的值加1。IF语句都需要使用END IF来结束。</p> <p>2．CASE语句</p> <p>CASE语句也用来进行条件判断，其可以实现比IF语句更复杂的条件判断。CASE语句的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CASE</span> case_value 
<span class="token keyword">WHEN</span> when_value <span class="token keyword">THEN</span> statement_list 
<span class="token punctuation">[</span><span class="token keyword">WHEN</span> when_value <span class="token keyword">THEN</span> statement_list<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token punctuation">[</span><span class="token keyword">ELSE</span> statement_list<span class="token punctuation">]</span> 
<span class="token keyword">END</span> <span class="token keyword">CASE</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其中，case_value参数表示条件判断的变量；</p> <p>when_value参数表示变量的取值；</p> <p>statement_list参数表示不同when_value值的执行语句。</p> <p>CASE语句还有另一种形式。该形式的语法如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CASE</span> 
<span class="token keyword">WHEN</span> search_condition <span class="token keyword">THEN</span> statement_list 
<span class="token punctuation">[</span><span class="token keyword">WHEN</span> search_condition <span class="token keyword">THEN</span> statement_list<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token punctuation">[</span><span class="token keyword">ELSE</span> statement_list<span class="token punctuation">]</span> 
<span class="token keyword">END</span> <span class="token keyword">CASE</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其中，search_condition参数表示条件判断语句；</p> <p>statement_list参数表示不同条件的执行语句。</p> <p>下面是一个CASE语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CASE</span> age 
<span class="token keyword">WHEN</span> <span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> <span class="token variable">@count1</span><span class="token operator">=</span><span class="token variable">@count1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">ELSE</span> <span class="token keyword">SET</span> <span class="token variable">@count2</span><span class="token operator">=</span><span class="token variable">@count2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">END</span> <span class="token keyword">CASE</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>代码也可以是下面的形式：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CASE</span> 
<span class="token keyword">WHEN</span> age<span class="token operator">=</span><span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> <span class="token variable">@count1</span><span class="token operator">=</span><span class="token variable">@count1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">ELSE</span> <span class="token keyword">SET</span> <span class="token variable">@count2</span><span class="token operator">=</span><span class="token variable">@count2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">END</span> <span class="token keyword">CASE</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>本示例中，如果age值为20，count1的值加1；否则count2的值加1。CASE语句都要使用END CASE结束。</p> <blockquote><p><strong>注意：这里的CASE语句和“控制流程函数”里描述的SQL CASE表达式的CASE语句有轻微不同。这里的CASE语句不能有ELSE NULL子句</strong></p> <p><strong>并且用END CASE替代END来终止！！</strong></p></blockquote> <p>3．LOOP语句</p> <p>LOOP语句可以使某些特定的语句重复执行，实现一个简单的循环。</p> <p>但是LOOP语句本身没有停止循环的语句，必须是遇到LEAVE语句等才能停止循环。</p> <p>LOOP语句的语法的基本形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span>begin_label:<span class="token punctuation">]</span> <span class="token keyword">LOOP</span> 
statement_list 
<span class="token keyword">END</span> <span class="token keyword">LOOP</span> <span class="token punctuation">[</span>end_label<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中，begin_label参数和end_label参数分别表示循环开始和结束的标志，这两个标志必须相同，而且都可以省略；</p> <p>statement_list参数表示需要循环执行的语句。</p> <p>下面是一个LOOP语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>add_num: <span class="token keyword">LOOP</span>  
<span class="token keyword">SET</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token variable">@count</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token keyword">END</span> <span class="token keyword">LOOP</span> add_num <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>该示例循环执行count加1的操作。因为没有跳出循环的语句，这个循环成了一个死循环。</p> <p>LOOP循环都以END LOOP结束。</p> <p>4．LEAVE语句</p> <p>LEAVE语句主要用于跳出循环控制。其语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">LEAVE</span> label 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，label参数表示循环的标志。</p> <p>下面是一个LEAVE语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>add_num: <span class="token keyword">LOOP</span> 
<span class="token keyword">SET</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token variable">@count</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">IF</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token number">100</span> <span class="token keyword">THEN</span> 
<span class="token keyword">LEAVE</span> add_num <span class="token punctuation">;</span> 
<span class="token keyword">END</span> <span class="token keyword">LOOP</span> add_num <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>该示例循环执行count加1的操作。当count的值等于100时，则LEAVE语句跳出循环。</p> <p>5．ITERATE语句</p> <p>ITERATE语句也是用来跳出循环的语句。但是，ITERATE语句是跳出本次循环，然后直接进入下一次循环。</p> <p>ITERATE语句只可以出现在LOOP、REPEAT、WHILE语句内。</p> <p>ITERATE语句的基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ITERATE</span> label 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，label参数表示循环的标志。</p> <p>下面是一个ITERATE语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>add_num: <span class="token keyword">LOOP</span> 
<span class="token keyword">SET</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token variable">@count</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">IF</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token number">100</span> <span class="token keyword">THEN</span> 
<span class="token keyword">LEAVE</span> add_num <span class="token punctuation">;</span> 
<span class="token keyword">ELSE</span> <span class="token keyword">IF</span> <span class="token function">MOD</span><span class="token punctuation">(</span><span class="token variable">@count</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">THEN</span> 
<span class="token keyword">ITERATE</span> add_num<span class="token punctuation">;</span> 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token punctuation">;</span> 
<span class="token keyword">END</span> <span class="token keyword">LOOP</span> add_num <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>该示例循环执行count加1的操作，count值为100时结束循环。如果count的值能够整除3，则跳出本次循环，不再执行下面的SELECT语句。</p> <p>说明：LEAVE语句和ITERATE语句都用来跳出循环语句，但两者的功能是不一样的。</p> <p>LEAVE语句是跳出整个循环，然后执行循环后面的程序。而ITERATE语句是跳出本次循环，然后进入下一次循环。</p> <p>使用这两个语句时一定要区分清楚。</p> <p>6．REPEAT语句</p> <p>REPEAT语句是有条件控制的循环语句。当满足特定条件时，就会跳出循环语句。REPEAT语句的基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span>begin_label:<span class="token punctuation">]</span> <span class="token keyword">REPEAT</span> 
statement_list 
UNTIL search_condition 
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span> <span class="token punctuation">[</span>end_label<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中，statement_list参数表示循环的执行语句；search_condition参数表示结束循环的条件，满足该条件时循环结束。</p> <p>下面是一个ITERATE语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">REPEAT</span> 
<span class="token keyword">SET</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token variable">@count</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
UNTIL <span class="token variable">@count</span><span class="token operator">=</span><span class="token number">100</span> 
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>该示例循环执行count加1的操作，count值为100时结束循环。</p> <p>REPEAT循环都用END REPEAT结束。</p> <p>7．WHILE语句</p> <p>WHILE语句也是有条件控制的循环语句。但WHILE语句和REPEAT语句是不一样的。</p> <p>WHILE语句是当满足条件时，执行循环内的语句。</p> <p>WHILE语句的基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span>begin_label:<span class="token punctuation">]</span> <span class="token keyword">WHILE</span> search_condition <span class="token keyword">DO</span> 
statement_list 
<span class="token keyword">END</span> <span class="token keyword">WHILE</span> <span class="token punctuation">[</span>end_label<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中，search_condition参数表示循环执行的条件，满足该条件时循环执行；</p> <p>statement_list参数表示循环的执行语句。</p> <p>下面是一个ITERATE语句的示例。代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">WHILE</span> <span class="token variable">@count</span><span class="token operator">&lt;</span><span class="token number">100</span> <span class="token keyword">DO</span> 
<span class="token keyword">SET</span> <span class="token variable">@count</span><span class="token operator">=</span><span class="token variable">@count</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">END</span> <span class="token keyword">WHILE</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>该示例循环执行count加1的操作，count值小于100时执行循环。</p> <p>如果count值等于100了，则跳出循环。WHILE循环需要使用END WHILE来结束。</p> <h2 id="调用存储过程和函数"><a href="#调用存储过程和函数" class="header-anchor">#</a> 调用存储过程和函数</h2> <p>存储过程和存储函数都是存储在服务器端的SQL语句的集合，要使用这些已经定义好的存储过程和存储函数就必须要通过调用的方式来实现</p> <p>存储过程是通过CALL语句来调用的。而存储函数的使用方法与MySQL内部函数的使用方法是一样的</p> <p>执行存储过程和存储函数需要拥有EXECUTE权限</p> <p>EXECUTE权限的信息存储在information_schema数据库下面的<strong>USER_PRIVILEGES</strong>表中</p> <p><strong>调用存储过程</strong></p> <p>MySQL中使用CALL语句来调用存储过程。调用存储过程后，数据库系统将执行存储过程中的语句。</p> <p>然后，将结果返回给输出值。</p> <p>CALL语句的基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CALL</span> sp_name<span class="token punctuation">(</span><span class="token punctuation">[</span>parameter<span class="token punctuation">[</span><span class="token punctuation">,</span>…<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，sp_name是存储过程的名称；parameter是指存储过程的参数。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CALL</span> <span class="token keyword">proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/0dae91d9e5b6a40c6207239a6845406f.jpeg" loading="lazy" class="lazy"></p> <p><strong>调用函数</strong></p> <p>在MySQL中，存储函数的使用方法与MySQL内部函数的使用方法是一样的。</p> <p>换言之，用户自己定义的存储函数与MySQL内部函数是一个性质的。</p> <p>区别在于，存储函数是用户自己定义的，而内部函数是MySQL的开发者定义的。</p> <p>下面定义一个存储函数，然后调用这个存储函数。</p> <p>代码执行如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 创建存储函数 </span>
<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> name_from_t3<span class="token punctuation">(</span>id <span class="token keyword">INT</span> <span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span>  
<span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  NAME  <span class="token keyword">FROM</span>  t3  <span class="token keyword">WHERE</span>  id<span class="token operator">=</span>id <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> name_from_t3<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/974cb2dfc475411c10cbccbead7900d6.jpeg" loading="lazy" class="lazy"></p> <p>上述存储函数的作用是根据输入的id值到t3表中查询记录。</p> <p>查询出id字段的值等于id的记录。然后将该记录的name字段的值返回。</p> <h2 id="查看存储过程和函数"><a href="#查看存储过程和函数" class="header-anchor">#</a> 查看存储过程和函数</h2> <p>存储过程和函数创建以后，可以查看存储过程和函数的状态和定义。</p> <p>通过SHOW STATUS语句来查看存储过程和函数的状态，也可以通过SHOW CREATE语句来查看存储过程和函数的定义。</p> <p>通过查询information_schema数据库下的Routines表来查看存储过程和函数的信息</p> <p>1、SHOW STATUS语句查看存储过程和函数的状态</p> <p>MySQL中可以通过SHOW STATUS语句查看存储过程和函数的状态。其基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span> { <span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span> } <span class="token keyword">STATUS</span> <span class="token punctuation">[</span> <span class="token operator">LIKE</span>  <span class="token string">' pattern '</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，PROCEDURE参数表示查询存储过程；FUNCTION参数表示查询存储函数；</p> <p>LIKE ' pattern '参数用来匹配存储过程或函数的名称。</p> <p>下面查询名为name_from_t3的函数的状态。代码执行如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span>  <span class="token keyword">FUNCTION</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'%name_from_t3%'</span>

Db      Name          <span class="token keyword">Type</span>      <span class="token keyword">Definer</span>         Modified             Created              Security_type  <span class="token keyword">Comment</span>  character_set_client  collation_connection  <span class="token keyword">Database</span> Collation
<span class="token comment">------  ------------  --------  --------------  -------------------  -------------------  -------------  -------  --------------------  --------------------  ------------------</span>
school  name_from_t3  <span class="token keyword">FUNCTION</span>  root<span class="token variable">@localhost</span>  <span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">18</span>:<span class="token number">52</span>:<span class="token number">39</span>  <span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">18</span>:<span class="token number">52</span>:<span class="token number">39</span>  <span class="token keyword">DEFINER</span>                 utf8                  utf8_general_ci       utf8_general_ci   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>查询结果显示了函数的创建时间、修改时间和字符集等信息。</p> <blockquote><p><strong>注意：SHOW STATUS语句只能查看存储过程或函数是操作哪一个数据库、存储过程或函数的名称、类型、谁定义的、创建和修改时间、字符编码等信息。</strong></p> <p><strong>但是，这个语句不能查询存储过程或函数的具体定义。如果需要查看详细定义，需要使用SHOW CREATE语句</strong></p></blockquote> <p>2、SHOW CREATE语句查看存储过程和函数的定义</p> <p>MySQL中可以通过SHOW CREATE语句查看存储过程和函数的状态。其基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> { <span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span> } sp_name <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，PROCEDURE参数表示查询存储过程；</p> <p>FUNCTION参数表示查询存储函数；</p> <p>sp_name参数表示存储过程或函数的名称</p> <p>下面查询名为name_from_t3的函数的定义。代码执行如下</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span>  name_from_t3

<span class="token keyword">Function</span>      sql_mode  <span class="token keyword">Create</span> <span class="token keyword">Function</span>                                                                                                                                  character_set_client  collation_connection  <span class="token keyword">Database</span> Collation
<span class="token comment">------------  --------  -----------------------------------------------------------------------------------------------------------------------------------------------  --------------------  --------------------  ------------------</span>
name_from_t3            <span class="token keyword">CREATE</span> <span class="token keyword">DEFINER</span><span class="token operator">=</span><span class="token identifier"><span class="token punctuation">`</span>root<span class="token punctuation">`</span></span><span class="token variable">@`localhost`</span> <span class="token keyword">FUNCTION</span> <span class="token identifier"><span class="token punctuation">`</span>name_from_t3<span class="token punctuation">`</span></span><span class="token punctuation">(</span>id <span class="token keyword">INT</span> <span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span> <span class="token keyword">CHARSET</span> utf8                                                 utf8                  utf8_general_ci       utf8_general_ci   
                        <span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  NAME  <span class="token keyword">FROM</span>  t3  <span class="token keyword">WHERE</span>  id<span class="token operator">=</span>id <span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>3、从information_schema.Routines表中查看存储过程和函数的信息</p> <p>存储过程和函数的信息存储在information_schema数据库下的Routines表中。可以通过查询该表的记录来查询存储过程和函数的信息。</p> <p>其基本语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines 
<span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">' sp_name '</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>其中，ROUTINE_NAME字段中存储的是存储过程和函数的名称；</p> <p>sp_name参数表示存储过程或函数的名称。</p> <p>下面从Routines表中查询名为name_from_t3函数的信息。</p> <p>代码执行如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines   <span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'name_from_t3'</span>

SPECIFIC_NAME  ROUTINE_CATALOG  ROUTINE_SCHEMA  ROUTINE_NAME  ROUTINE_TYPE  DATA_TYPE  CHARACTER_MAXIMUM_LENGTH  CHARACTER_OCTET_LENGTH  NUMERIC_PRECISION  NUMERIC_SCALE  CHARACTER_SET_NAME  COLLATION_NAME   DTD_IDENTIFIER  ROUTINE_BODY  ROUTINE_DEFINITION                              EXTERNAL_NAME  EXTERNAL_LANGUAGE  PARAMETER_STYLE  IS_DETERMINISTIC  SQL_DATA_ACCESS  SQL_PATH  SECURITY_TYPE  CREATED              LAST_ALTERED         SQL_MODE  ROUTINE_COMMENT  <span class="token keyword">DEFINER</span>         CHARACTER_SET_CLIENT  COLLATION_CONNECTION  DATABASE_COLLATION
<span class="token comment">-------------  ---------------  --------------  ------------  ------------  ---------  ------------------------  ----------------------  -----------------  -------------  ------------------  ---------------  --------------  ------------  ----------------------------------------------  -------------  -----------------  ---------------  ----------------  ---------------  --------  -------------  -------------------  -------------------  --------  ---------------  --------------  --------------------  --------------------  ------------------</span>
name_from_t3   def              school          name_from_t3  <span class="token keyword">FUNCTION</span>      <span class="token keyword">char</span>                             <span class="token number">80</span>                     <span class="token number">240</span>             <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>  utf8                utf8_general_ci  <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span>        <span class="token keyword">SQL</span>           <span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  NAME  <span class="token keyword">FROM</span>  t3  <span class="token keyword">WHERE</span>  id<span class="token operator">=</span>id <span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>             <span class="token keyword">SQL</span>              <span class="token keyword">NO</span>                <span class="token keyword">CONTAINS</span> <span class="token keyword">SQL</span>     <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span>    <span class="token keyword">DEFINER</span>        <span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">18</span>:<span class="token number">52</span>:<span class="token number">39</span>  <span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">18</span>:<span class="token number">52</span>:<span class="token number">39</span>                             root<span class="token variable">@localhost</span>  utf8                  utf8_general_ci       utf8_general_ci   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>查询结果显示name_from_t3的详细信息。</p> <blockquote><p><strong>注意：在information_schema数据库下的Routines表中，存储着所有存储过程和函数的定义。</strong></p> <p><strong>如果使用SELECT语句查询Routines表中的存储过程和函数的定义时，一定要使用ROUTINE_NAME字段指定存储过程或函数的名称。</strong></p> <p><strong>否则，将查询出所有的存储过程或函数的定义。</strong></p></blockquote> <h2 id="修改存储过程和函数"><a href="#修改存储过程和函数" class="header-anchor">#</a> 修改存储过程和函数</h2> <p>修改存储过程和函数是指修改已经定义好的存储过程和函数。</p> <p>MySQL中通过ALTER PROCEDURE语句来修改存储过程。</p> <p>通过ALTER FUNCTION语句来修改存储函数。</p> <p>MySQL中修改存储过程和函数的语句的语法形式如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> {<span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span>} sp_name <span class="token punctuation">[</span>characteristic <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>  
characteristic:  
{ <span class="token keyword">CONTAINS</span> <span class="token keyword">SQL</span> <span class="token operator">|</span> <span class="token keyword">NO</span> <span class="token keyword">SQL</span> <span class="token operator">|</span> <span class="token keyword">READS</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span> <span class="token operator">|</span> <span class="token keyword">MODIFIES</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span> }  
<span class="token operator">|</span> <span class="token keyword">SQL</span> SECURITY { <span class="token keyword">DEFINER</span> <span class="token operator">|</span> <span class="token keyword">INVOKER</span> }  
<span class="token operator">|</span> <span class="token keyword">COMMENT</span> <span class="token string">'string'</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其中，sp_name参数表示存储过程或函数的名称；</p> <ul><li>characteristic参数指定存储函数的特性。</li> <li>CONTAINS SQL表示子程序包含SQL语句，但不包含读或写数据的语句；</li> <li>NO SQL表示子程序中不包含SQL语句；</li> <li>READS SQL DATA表示子程序中包含读数据的语句；</li> <li>MODIFIES SQL DATA表示子程序中包含写数据的语句。</li> <li>SQL SECURITY { DEFINER | INVOKER }指明谁有权限来执行。</li> <li>DEFINER表示只有定义者自己才能够执行；</li> <li>INVOKER表示调用者可以执行。</li> <li>COMMENT 'string'是注释信息。</li></ul> <p>说明：修改存储过程使用ALTER PROCEDURE语句，修改存储函数使用ALTER FUNCTION语句。但是，这两个语句的结构是一样的，语句中的所有参数都是一样的。而且，它们与创建存储过程或函数的语句中的参数也是基本一样的。修改存储过程和函数，只能修改他们的权限，目前MySQL还不提供对已存在的存储过程和函数代码的修改。如果要修改，只能通过先DROP掉，然后重新建立新的存储过程和函数来实现</p> <p>在SQLYOG里选中选中函数，然后右键ALTER FUNCTION的时候，也是这样，先DROP掉，然后重新建立新的函数来实现</p> <p><img alt="" data-src="https://img-blog.csdnimg.cn/img_convert/39d836d1cc8d1527ca879f9d52d2591c.jpeg" loading="lazy" class="lazy"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELIMITER</span> $$
<span class="token keyword">DROP</span> <span class="token keyword">FUNCTION</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>name_from_t3<span class="token punctuation">`</span></span>$$

<span class="token keyword">CREATE</span> <span class="token keyword">DEFINER</span><span class="token operator">=</span><span class="token identifier"><span class="token punctuation">`</span>root<span class="token punctuation">`</span></span><span class="token variable">@`localhost`</span> <span class="token keyword">FUNCTION</span> <span class="token identifier"><span class="token punctuation">`</span>name_from_t3<span class="token punctuation">`</span></span><span class="token punctuation">(</span>id <span class="token keyword">INT</span> <span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span> <span class="token keyword">CHARSET</span> utf8
<span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  NAME  <span class="token keyword">FROM</span>  t3  <span class="token keyword">WHERE</span>  id<span class="token operator">=</span>id <span class="token punctuation">)</span>$$
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="删除存储过程和函数"><a href="#删除存储过程和函数" class="header-anchor">#</a> 删除存储过程和函数</h2> <p>删除存储过程和函数指删除数据库中已经存在的存储过程和函数。</p> <p>MySQL中使用DROP PROCEDURE语句来删除存储过程。通过DROP FUNCTION语句来删除存储函数。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> { <span class="token keyword">PROCEDURE</span><span class="token operator">|</span> <span class="token keyword">FUNCTION</span> } sp_name<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，sp_name参数表示存储过程或函数的名称</p> <p>下面删除存储过程Proc和存储函数name_from_t3。删除存储过程的代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span>  <span class="token keyword">PROCEDURE</span>  <span class="token keyword">Proc</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除存储函数name_from_employee的代码如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span>  <span class="token keyword">FUNCTION</span>  name_from_t3<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>删除完毕之后，查询information_schema.Routines来确认上面的删除是否成功</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines
<span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'proc'</span> <span class="token operator">OR</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'name_from_t3'</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p><strong>TIPS:</strong></p> <p>存储过程里面是可以调用其他存储过程的，使用CALL语句调用其他存储过程就可以了</p> <p>存储过程参数列表里的参数名尽量不要和数据库中表的字段名一样，否则有可能出错</p> <p>存储过程的参数可以使用中文，在定义存储过程的时候加上character set gbk就可以了</p> <p>例如</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> useInfo<span class="token punctuation">(</span><span class="token operator">IN</span> u_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> gbk<span class="token punctuation">,</span><span class="token keyword">OUT</span> u_age <span class="token keyword">INT</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>补充</strong></p> <p>DECLARE 语句要写在存储过程里面，否则会报错！！</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">Proc</span><span class="token punctuation">;</span>

<span class="token keyword">DELIMITER</span> <span class="token comment">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> command_not_allowed CONDITION <span class="token keyword">FOR</span> SQLSTATE <span class="token string">'42000'</span> <span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token comment">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token keyword">CALL</span> <span class="token keyword">Proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>好了，如果文章对你有点帮助，记得给冰河一键三连哦，欢迎将文章转发给更多的小伙伴，冰河将不胜感激~~</strong></p> <p><strong>好了，如果文章对你有点帮助，记得给冰河一键三连哦，欢迎将文章转发给更多的小伙伴，冰河将不胜感激~~</strong></p> <h2 id="关于星球"><a href="#关于星球" class="header-anchor">#</a> 关于星球</h2> <p><strong>冰河技术</strong> 知识星球《RPC手撸专栏》已经开始了，我会将《RPC手撸专栏》的源码放到知识星球中，同时在微信上会创建专门的知识星球群，冰河会在知识星球上和星球群里解答球友的提问。</p> <h3 id="星球提供的服务"><a href="#星球提供的服务" class="header-anchor">#</a> 星球提供的服务</h3> <p>冰河整理了星球提供的一些服务，如下所示。</p> <p>加入星球，你将获得：</p> <p>1.学习从零开始手撸可用于实际场景的高性能、可扩展的RPC框架项目</p> <p>2.学习SpringCloud Alibaba实战项目—从零开发微服务项目</p> <p>3.学习高并发、大流量业务场景的解决方案，体验大厂真正的高并发、大流量的业务场景</p> <p>4.学习进大厂必备技能：性能调优、并发编程、分布式、微服务、框架源码、中间件开发、项目实战</p> <p>5.提供站点 https://binghe.gitcode.host 所有学习内容的指导、帮助</p> <p>6.GitHub：https://github.com/binghe001/BingheGuide - 非常有价值的技术资料仓库，包括冰河所有的博客开放案例代码</p> <p>7.可以发送你的简历到我的邮箱，提供简历批阅服务</p> <p>8.提供技术问题、系统架构、学习成长、晋升答辩等各项内容的回答</p> <p>9.定期的整理和分享出各类专属星球的技术小册、电子书、编程视频、PDF文件</p> <p>10.定期组织技术直播分享，传道、授业、解惑，指导阶段瓶颈突破技巧</p> <h3 id="如何加入星球"><a href="#如何加入星球" class="header-anchor">#</a> 如何加入星球</h3> <ul><li><strong>链接</strong> ：打开链接 <a href="http://m6z.cn/6aeFbs" target="_blank" rel="noopener noreferrer">http://m6z.cn/6aeFbs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 加入星球。</li> <li><strong>回复</strong> ：在公众号 <strong>冰河技术</strong> 回复 <strong>星球</strong> 领取优惠券加入星球。</li></ul> <p><strong>特别提醒：</strong> 苹果用户进圈或续费，请加微信 <strong>hacker_binghe</strong> 扫二维码，或者去公众号 <strong>冰河技术</strong> 回复 <strong>星球</strong> 扫二维码加入星球。</p> <p><img alt="sa-2022-04-21-007" data-src="https://binghe.gitcode.host/assets/images/microservices/springcloudalibaba/sa-2022-04-28-008.png" loading="lazy" class="lazy"></p> <p><strong>如果图片二维码过期，去公众号 冰河技术 回复 星球 扫二维码加入星球, 好了，今天就到这儿吧，我是冰河，我们下期见~~</strong></p> <h2 id="写在最后"><a href="#写在最后" class="header-anchor">#</a> 写在最后</h2> <blockquote><p>如果你觉得冰河写的还不错，请微信搜索并关注「 <strong>冰河技术</strong> 」微信公众号，跟冰河学习高并发、分布式、微服务、大数据、互联网和云原生技术，「 <strong>冰河技术</strong> 」微信公众号更新了大量技术专题，每一篇技术文章干货满满！不少读者已经通过阅读「 <strong>冰河技术</strong> 」微信公众号文章，吊打面试官，成功跳槽到大厂；也有不少读者实现了技术上的飞跃，成为公司的技术骨干！如果你也想像他们一样提升自己的能力，实现技术能力的飞跃，进大厂，升职加薪，那就关注「 <strong>冰河技术</strong> 」微信公众号吧，每天更新超硬核技术干货，让你对如何提升技术能力不再迷茫！</p></blockquote> <p><img alt="" data-src="https://img-blog.csdnimg.cn/20200906013715889.png" loading="lazy" class="lazy"></p> <h2 id="加群交流"><a href="#加群交流" class="header-anchor">#</a> 加群交流</h2> <p>本群的宗旨是给大家提供一个良好的技术学习交流平台，所以杜绝一切广告！由于微信群人满 100 之后无法加入，请扫描下方二维码先添加作者 “冰河” 微信(hacker_binghe)，备注：<code>学习加群</code>。</p> <div align="center"><img src="https://binghe.gitcode.host/images/personal/hacker_binghe.jpg?raw=true" width="180px"> <div style="font-size:9px;">冰河微信</div> <br></div> <h2 id="公众号"><a href="#公众号" class="header-anchor">#</a> 公众号</h2> <p>分享各种编程语言、开发技术、分布式与微服务架构、分布式数据库、分布式事务、云原生、大数据与云计算技术和渗透技术。另外，还会分享各种面试题和面试技巧。</p> <div align="center"><img src="https://img-blog.csdnimg.cn/20210426115714643.jpg?raw=true" width="180px"> <div style="font-size:9px;">公众号：冰河技术</div> <br></div> <h2 id="星球"><a href="#星球" class="header-anchor">#</a> 星球</h2> <p>加入星球 <strong><a href="http://m6z.cn/6aeFbs" target="_blank" rel="noopener noreferrer">冰河技术<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong>，可以获得本站点所有学习内容的指导与帮助。如果你遇到不能独立解决的问题，也可以添加冰河的微信：<strong>hacker_binghe</strong>， 我们一起沟通交流。另外，在星球中不只能学到实用的硬核技术，还能学习<strong>实战项目</strong>！</p> <p>关注 <a href="https://img-blog.csdnimg.cn/20210426115714643.jpg?raw=true" target="_blank" rel="noopener noreferrer">冰河技术<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>公众号，回复 <code>星球</code> 可以获取入场优惠券。</p> <div align="center"><img src="https://binghe.gitcode.host/images/personal/xingqiu.png?raw=true" width="180px"> <div style="font-size:9px;">知识星球：冰河技术</div> <br></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/binghe001/BingheGuide/edit/master/docs/md/core/mysql/base/2022-08-29-《MySQL核心知识》第10章：自定义存储过程和函数.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2023/1/20</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/md/core/mysql/base/2022-08-22-《MySQL核心知识》第9章-函数.html" class="prev">
          第9章：函数
        </a></span> <span class="next"><a href="/md/core/mysql/base/2022-09-16-《MySQL核心知识》第11章：视图.html">
          第11章：视图
        </a>
        →
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">第10章：自定义存储过程和函数</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#创建存储过程" class="toc-sidebar-link">创建存储过程</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#存储函数" class="toc-sidebar-link">存储函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#变量的使用" class="toc-sidebar-link">变量的使用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#定义条件和处理程序" class="toc-sidebar-link">定义条件和处理程序</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#光标" class="toc-sidebar-link">光标</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#流程控制的使用" class="toc-sidebar-link">流程控制的使用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#调用存储过程和函数" class="toc-sidebar-link">调用存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#查看存储过程和函数" class="toc-sidebar-link">查看存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#修改存储过程和函数" class="toc-sidebar-link">修改存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#删除存储过程和函数" class="toc-sidebar-link">删除存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#总结" class="toc-sidebar-link">总结</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#关于星球" class="toc-sidebar-link">关于星球</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#星球提供的服务" class="toc-sidebar-link">星球提供的服务</a></li><li class="toc-sidebar-sub-header"><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#如何加入星球" class="toc-sidebar-link">如何加入星球</a></li></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#写在最后" class="toc-sidebar-link">写在最后</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#加群交流" class="toc-sidebar-link">加群交流</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#公众号" class="toc-sidebar-link">公众号</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#星球" class="toc-sidebar-link">星球</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">第10章：自定义存储过程和函数</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#创建存储过程" class="toc-sidebar-link">创建存储过程</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#存储函数" class="toc-sidebar-link">存储函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#变量的使用" class="toc-sidebar-link">变量的使用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#定义条件和处理程序" class="toc-sidebar-link">定义条件和处理程序</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#光标" class="toc-sidebar-link">光标</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#流程控制的使用" class="toc-sidebar-link">流程控制的使用</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#调用存储过程和函数" class="toc-sidebar-link">调用存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#查看存储过程和函数" class="toc-sidebar-link">查看存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#修改存储过程和函数" class="toc-sidebar-link">修改存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#删除存储过程和函数" class="toc-sidebar-link">删除存储过程和函数</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#总结" class="toc-sidebar-link">总结</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#关于星球" class="toc-sidebar-link">关于星球</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#星球提供的服务" class="toc-sidebar-link">星球提供的服务</a></li><li class="toc-sidebar-sub-header"><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#如何加入星球" class="toc-sidebar-link">如何加入星球</a></li></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#写在最后" class="toc-sidebar-link">写在最后</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#加群交流" class="toc-sidebar-link">加群交流</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#公众号" class="toc-sidebar-link">公众号</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html#星球" class="toc-sidebar-link">星球</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/wechat.png" class="nozoom"> <span class="show-txt">手机看</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.9rem">微信扫一扫</span> <img height="180px" src="https://api.qrserver.com/v1/create-qr-code/?data=https://binghe.gitcode.host/md/core/mysql/base/2022-08-29-%E3%80%8AMySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E3%80%8B%E7%AC%AC10%E7%AB%A0%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0.html" style="margin:10px;">
                可以<b>手机看</b>或分享至<b>朋友圈</b></div></div></div></div> <div class="option-box"><img src="/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div class="option-box"><img src="/images/system/xingqiu.png" width="25px" class="nozoom"> <span class="show-txt">星球</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">实战项目<span style="font-size:8px;color:red;">「SpringCloud Alibaba实战项目」</span>、专属电子书、问题解答、简历指导、技术分享、晋升指导、视频课程</span> <img height="180px" src="/images/personal/xingqiu.png" style="margin:10px;"> <b>知识星球</b>：冰河技术
            </div></div></div></div> <div class="option-box"><img src="/images/system/wexin4.png" width="25px" class="nozoom"> <span class="show-txt">读者群</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">添加冰河微信<span style="color:red;">(hacker_binghe)</span>进冰河技术学习交流圈「无任何套路」</span> <img src="/images/personal/hacker_binghe.jpg" height="180px" style="margin:10px;">
                PS：添加时请备注<b>读者加群</b>，谢谢！
              </div></div></div></div> <div class="option-box"><img src="/images/system/download-2.png" width="25px" class="nozoom"> <span class="show-txt">下资料</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">扫描公众号，回复<span style="color:red;">“1024”</span>下载<span style="color:red;">100GB+</span>学习技术资料、PDF书籍、实战项目、简历模板等「无任何套路」</span> <img src="/images/personal/qrcode.png" height="180px" style="margin:10px;"> <b>公众号:</b> 冰河技术
              </div></div></div></div> <div class="option-box"><img src="/images/system/heart-1.png" width="25px" class="nozoom"> <span class="show-txt">赞赏我</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">鼓励/支持/赞赏我</span> <img height="180px" src="/images/personal/encourage-head.png" style="margin:5px;"> <br>1. 不靠它生存但仍希望得到你的鼓励；
                <br>2. 时刻警醒自己保持技术人的初心；
              </div></div></div></div> <div title="第9章：函数" class="option-box" style="padding-left:2px;text-align:center;"><a href="/md/core/mysql/base/2022-08-22-《MySQL核心知识》第9章-函数.html"><img src="/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="第11章：视图" class="option-box" style="padding-left:2px;text-align:center;"><a href="/md/core/mysql/base/2022-09-16-《MySQL核心知识》第11章：视图.html"><img src="/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div>  <!----> </aside></div><div class="global-ui"><div class="read-more-wrap" style="display:none;position:absolute;bottom:0px;z-index:9999;width:100%;margin-top:-100px;font-family:PingFangSC-Regular, sans-serif;"><div id="read-more-mask" style="position: relative; height: 200px; background: -webkit-gradient(linear, 0 0%, 0 100%, from(rgba(255, 255, 255, 0)), to(rgb(255, 255, 255)));"></div> <a id="read-more-btn" target="_self" style="position: absolute; left: 50%; top: 70%; bottom: 30px; transform: translate(-50%, -50%); width: 160px; height: 36px; line-height: 36px; font-size: 15px; text-align: center; border: 1px solid rgb(222, 104, 109); color: rgb(222, 104, 109); background: rgb(255, 255, 255); cursor: pointer; border-radius: 6px;">阅读全文</a> <div id="btw-modal-wrap" style="display: none;"><div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0);"></div> <div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;"><span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 34px; font-size: 34px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">×</span> <p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px;">
                扫码或搜索：<span style="color: #E9405A; font-weight: bold;">冰河技术</span> <br>发送：<span id="fustack-token" class="token" style="color: #e9415a; font-weight: bold; font-size: 17px; margin-bottom: 45px;">290992</span> <br>即可<span style="color: #e9415a; font-weight: bold;">立即永久</span>解锁本站全部文章</p> <img src="/images/personal/qrcode.png" style="width: 180px; margin-top: 10px; margin-bottom: 30px; border: 8px solid rgb(230, 230, 230);"></div></div></div><div class="pay-read-more-wrap" style="display:none;position:absolute;bottom:0px;z-index:9999;width:100%;margin-top:-100px;font-family:PingFangSC-Regular, sans-serif;"><div id="pay-read-more-mask" style="position: relative; height: 200px; background: -webkit-gradient(linear, 0 0%, 0 100%, from(rgba(255, 255, 255, 0)), to(rgb(255, 255, 255)));"></div> <a id="pay-read-more-btn" target="_blank" style="position: absolute; left: 50%; top: 70%; bottom: 30px; transform: translate(-50%, -50%); width: 160px; height: 36px; line-height: 36px; font-size: 15px; text-align: center; border: 1px solid rgb(222, 104, 109); color: rgb(222, 104, 109); background: rgb(255, 255, 255); cursor: pointer; border-radius: 6px;">付费阅读</a></div></div></div>
    <script src="/assets/js/cg-styles.js?v=1674202622151" defer></script><script src="/assets/js/cg-3.js?v=1674202622151" defer></script><script src="/assets/js/cg-4.js?v=1674202622151" defer></script><script src="/assets/js/cg-87.js?v=1674202622151" defer></script><script src="/assets/js/cg-5.js?v=1674202622151" defer></script><script src="/assets/js/cg-6.js?v=1674202622151" defer></script><script src="/assets/js/cg-app.js?v=1674202622151" defer></script>
  </body>
</html>

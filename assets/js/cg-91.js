(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{380:function(s,a,t){"use strict";t.r(a);var r=t(7),e=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"《mysql核心知识》第14章-数据备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#《mysql核心知识》第14章-数据备份与恢复"}},[s._v("#")]),s._v(" 《MySQL核心知识》第14章：数据备份与恢复")]),s._v(" "),a("p",[a("strong",[s._v("大家好，我是冰河~~")])]),s._v(" "),a("p",[s._v("今天是《MySQL核心知识》专栏的第14章，今天为大家系统的讲讲MySQL中的数据备份与恢复，希望通过本章节的学习，小伙伴们能够举一反三，彻底掌握MySQL中的数据备份与恢复相关的知识。好了，开始今天的正题吧。")]),s._v(" "),a("h2",{attrs:{id:"备份-恢复策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份-恢复策略"}},[s._v("#")]),s._v(" 备份/恢复策略")]),s._v(" "),a("p",[s._v("1.定期做 mysql备份，并考虑系统可以承受的恢复时间。")]),s._v(" "),a("p",[s._v("2.确保 mysql 打开log-bin，有了 binarylog，mysql才可以在必要的时候做完整恢复，或基于时间点的恢复，或基于位置的恢复。")]),s._v(" "),a("p",[s._v("3.要经常做备份恢复测试，确保备份是有效的，并且是可以恢复的。")]),s._v(" "),a("h2",{attrs:{id:"冷备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#冷备份"}},[s._v("#")]),s._v(" 冷备份")]),s._v(" "),a("h3",{attrs:{id:"备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份"}},[s._v("#")]),s._v(" 备份")]),s._v(" "),a("p",[s._v("1.停掉 mysql服务，在操作系统级别备份 mysql的数据文件。")]),s._v(" "),a("p",[s._v("2.重启 mysql服务，备份重启以后生成的 binlog。")]),s._v(" "),a("h3",{attrs:{id:"恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恢复"}},[s._v("#")]),s._v(" 恢复")]),s._v(" "),a("p",[s._v("1.停掉 mysql服务，在操作系统级别恢复 mysql的数据文件。")]),s._v(" "),a("p",[s._v("2.重启 mysql服务，使用 mysqlbinlog恢复自备份以来的 binlog。")]),s._v(" "),a("h2",{attrs:{id:"逻辑备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#逻辑备份"}},[s._v("#")]),s._v(" 逻辑备份")]),s._v(" "),a("h3",{attrs:{id:"备份-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份-2"}},[s._v("#")]),s._v(" 备份")]),s._v(" "),a("p",[s._v("1.选择在系统空闲时，比如在夜间，使用 mysqldump –F(flush-logs)备份数据库。")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqldump –u root –p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" pointcard –F "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pointcard"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2.并备份 mysqldump开始以后生成的 binlog。")]),s._v(" "),a("h3",{attrs:{id:"恢复-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恢复-2"}},[s._v("#")]),s._v(" 恢复")]),s._v(" "),a("p",[s._v("1.停掉应用，执行 mysql 导入备份文件.")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysql –u root –p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" pointcard "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" pointcard"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2.使用 mysqlbinlog 恢复自mysqldump 备份以来的binlog。")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqlbinlog $HOME"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root –p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"单个表的备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单个表的备份"}},[s._v("#")]),s._v(" 单个表的备份")]),s._v(" "),a("h3",{attrs:{id:"备份-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份-3"}},[s._v("#")]),s._v(" 备份")]),s._v(" "),a("p",[s._v("1.方法 1：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("outfile")]),s._v(" ‘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("order_tab’ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fields")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("terminated")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("’ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" order_tab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2.方法 2：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqldump –u root –p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" –T "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp pointcard order_tab "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--fields-terminated-by=’,’;")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"恢复-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恢复-3"}},[s._v("#")]),s._v(" 恢复")]),s._v(" "),a("p",[s._v("1.方法 1：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("load")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("local")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("infile")]),s._v(" ‘"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("order_tab’ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" order_tab "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fields")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("terminated")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2.方法 2：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqlimport –u root –p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--local] pointcatd order_tab.txt --fields-terminated-by=’,’;")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("注意：如果导入和导出是跨平台操作的（windows和 linux），那么要注意设置参数line-terminated-by， windows上设置为 line-terminated-by=’\\r\\n’，linux上设置为line-terminated-by=’\\n’.")]),s._v(" "),a("h2",{attrs:{id:"使用备份工具ibbackup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用备份工具ibbackup"}},[s._v("#")]),s._v(" 使用备份工具ibbackup")]),s._v(" "),a("p",[s._v("ibbackup是 innodb公司（www.innodb.com)的一个热备份工具，专门对 innodb存储引擎进行物理热备份，此工具是收费的，不能免费使用。现在innodb 公司已经被oracle收购")]),s._v(" "),a("p",[s._v("使用方法：")]),s._v(" "),a("p",[s._v("编辑用于启动的配置文件my.cnf和用于备份的配置文件my2.cnf")]),s._v(" "),a("p",[s._v("my.cnf的例子如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/data \n\ninnodb_data_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/data\ninnodb_data_file_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ibdata1:10M:autoextend\ninnodb_log_group_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/data\nset-variable "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_files_in_group")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nset-variable "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_file_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("20M\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("如果想备份到/home/heikki/backup，则my2.cnf的例子如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/backup\ninnodb_data_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/backup\ninnodb_data_file_path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ibdata1:10M:autoextend\ninnodb_log_group_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/heikki/backup\nset-variable "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_files_in_group")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nset-variable "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_file_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("20M\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("开始备份ibbackup my.cnf my2.cnf如果需要恢复，则进行日志重做ibbackup --apply-log my2.cnf恢复后重启数据库服务./bin/mysqld_saft --defaults-file=my2.cnf &")]),s._v(" "),a("h2",{attrs:{id:"时间点恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间点恢复"}},[s._v("#")]),s._v(" 时间点恢复")]),s._v(" "),a("p",[s._v("1.如果上午 10点发生了误操作，可以用以下语句用备份和 binglog将数据恢复到故障前：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqlbinlog --stop-date"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-07-08 9:59:59"')]),s._v(" /var/log/mysql/bin.123456 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root –pmypwd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2.跳过故障时的时间点，继续执行后面的 binlog，完成恢复")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqlbinlog --start-date"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-07-08 10:01:00"')]),s._v(" /var/log/mysql/bin.123456"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-pmypwd")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"位置恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#位置恢复"}},[s._v("#")]),s._v(" 位置恢复")]),s._v(" "),a("p",[s._v("和时间点恢复类似，但是更精确，步骤如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mysqlbinlog --start-date"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-07-08 9:55:00"')]),s._v(" --stop-date"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-07-08 10:05:00"')]),s._v(" /var/log/mysql/bin.123456 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /tmp/mysql_restore.sql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("该命令将在/tmp目录创建小的文本文件，编辑此文件，找到出错语句前后的位置号 ，例如前后位置号分别是368312 和368315。恢复了以前的备份文件后，你应从命令行输入下面内容：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqlbinlog "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('--stop-position="368312" /var/log/mysql/bin.123456 | mysql -u root -pmypwd')]),s._v("\nmysqlbinlog "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('--start-position="368315" /var/log/mysql/bin.123456 | mysql -u root -pmypwd')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("上面的第1 行将恢复到停止位置为止的所有事务。下一行将恢复从给定的起始位置直到二进制日志结束的所有事务。因为mysqlbinlog 的输出包括每个SQL 语句记录之前的SET TIMESTAMP 语句，恢复的数据和相关MySQL 日志将反应事务执行的原时间。")]),s._v(" "),a("p",[s._v("MyISAM表修复：\n一张损坏的表的症状通常是查询意外中断并且能看到下述错误：")]),s._v(" "),a("ul",[a("li",[s._v("“tbl_name.frm”被锁定不能更改。")]),s._v(" "),a("li",[s._v("不能找到文件“tbl_name.MYI”（Errcode：nnn）。")]),s._v(" "),a("li",[s._v("文件意外结束。")]),s._v(" "),a("li",[s._v("记录文件被毁坏。")]),s._v(" "),a("li",[s._v("从表处理器得到错误nnn")])]),s._v(" "),a("p",[s._v("解决方法如下：")]),s._v(" "),a("p",[s._v("方法一：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("myisamchk "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r tablename\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面的方法几乎能解决所有问题，如果不行，则使用：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("myisamchk "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o tablename\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("方法二：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHECK")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" tbl_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tbl_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" {"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("QUICK")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" FAST "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" MEDIUM "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXTENDED")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" CHANGED}\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" REPAIR "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LOCAL")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" NO_WRITE_TO_BINLOG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v("\ntbl_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tbl_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("QUICK")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXTENDED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("USE_FRM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("注意：有关更多MySQL数据备份与恢复的知识，大家可以查阅《MySQL技术大全：开发、优化与运维实战》一书。")]),s._v(" "),a("p",[a("strong",[s._v("好了，如果文章对你有点帮助，记得给冰河一键三连哦，欢迎将文章转发给更多的小伙伴，冰河将不胜感激~~")])]),s._v(" "),a("h2",{attrs:{id:"关于星球"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于星球"}},[s._v("#")]),s._v(" 关于星球")]),s._v(" "),a("p",[a("strong",[s._v("冰河技术")]),s._v(" 知识星球《RPC手撸专栏》已经开始了，我会将《RPC手撸专栏》的源码放到知识星球中，同时在微信上会创建专门的知识星球群，冰河会在知识星球上和星球群里解答球友的提问。")]),s._v(" "),a("h3",{attrs:{id:"星球提供的服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#星球提供的服务"}},[s._v("#")]),s._v(" 星球提供的服务")]),s._v(" "),a("p",[s._v("冰河整理了星球提供的一些服务，如下所示。")]),s._v(" "),a("p",[s._v("加入星球，你将获得：")]),s._v(" "),a("p",[s._v("1.学习从零开始手撸可用于实际场景的高性能、可扩展的RPC框架项目")]),s._v(" "),a("p",[s._v("2.学习SpringCloud Alibaba实战项目—从零开发微服务项目")]),s._v(" "),a("p",[s._v("3.学习高并发、大流量业务场景的解决方案，体验大厂真正的高并发、大流量的业务场景")]),s._v(" "),a("p",[s._v("4.学习进大厂必备技能：性能调优、并发编程、分布式、微服务、框架源码、中间件开发、项目实战")]),s._v(" "),a("p",[s._v("5.提供站点 https://binghe001.github.io 所有学习内容的指导、帮助")]),s._v(" "),a("p",[s._v("6.GitHub：https://github.com/binghe001/BingheGuide - 非常有价值的技术资料仓库，包括冰河所有的博客开放案例代码")]),s._v(" "),a("p",[s._v("7.提供技术问题、系统架构、学习成长、晋升答辩等各项内容的回答")]),s._v(" "),a("p",[s._v("8.定期的整理和分享出各类专属星球的技术小册、电子书、编程视频、PDF文件")]),s._v(" "),a("p",[s._v("9.定期组织技术直播分享，传道、授业、解惑，指导阶段瓶颈突破技巧")]),s._v(" "),a("h3",{attrs:{id:"如何加入星球"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何加入星球"}},[s._v("#")]),s._v(" 如何加入星球")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("链接")]),s._v(" ：打开链接 "),a("a",{attrs:{href:"http://m6z.cn/6aeFbs",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://m6z.cn/6aeFbs"),a("OutboundLink")],1),s._v(" 加入星球。")]),s._v(" "),a("li",[a("strong",[s._v("回复")]),s._v(" ：在公众号 "),a("strong",[s._v("冰河技术")]),s._v(" 回复 "),a("strong",[s._v("星球")]),s._v(" 领取优惠券加入星球。")])]),s._v(" "),a("p",[a("strong",[s._v("特别提醒：")]),s._v(" 苹果用户进圈或续费，请加微信 "),a("strong",[s._v("hacker_binghe")]),s._v(" 扫二维码，或者去公众号 "),a("strong",[s._v("冰河技术")]),s._v(" 回复 "),a("strong",[s._v("星球")]),s._v(" 扫二维码加入星球。")]),s._v(" "),a("p",[a("strong",[s._v("好了，今天就到这儿吧，我是冰河，我们下期见~~")])]),s._v(" "),a("h2",{attrs:{id:"加群交流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加群交流"}},[s._v("#")]),s._v(" 加群交流")]),s._v(" "),a("p",[s._v("本群的宗旨是给大家提供一个良好的技术学习交流平台，所以杜绝一切广告！由于微信群人满 100 之后无法加入，请扫描下方二维码先添加作者 “冰河” 微信(hacker_binghe)，备注："),a("code",[s._v("学习加群")]),s._v("。")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://binghe001.github.io/images/personal/hacker_binghe.jpg?raw=true",width:"180px"}}),s._v(" "),a("div",{staticStyle:{"font-size":"9px"}},[s._v("冰河微信")]),s._v(" "),a("br")]),s._v(" "),a("h2",{attrs:{id:"公众号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#公众号"}},[s._v("#")]),s._v(" 公众号")]),s._v(" "),a("p",[s._v("分享各种编程语言、开发技术、分布式与微服务架构、分布式数据库、分布式事务、云原生、大数据与云计算技术和渗透技术。另外，还会分享各种面试题和面试技巧。")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210426115714643.jpg?raw=true",width:"180px"}}),s._v(" "),a("div",{staticStyle:{"font-size":"9px"}},[s._v("公众号：冰河技术")]),s._v(" "),a("br")]),s._v(" "),a("h2",{attrs:{id:"星球"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#星球"}},[s._v("#")]),s._v(" 星球")]),s._v(" "),a("p",[s._v("加入星球 "),a("strong",[a("a",{attrs:{href:"http://m6z.cn/6aeFbs",target:"_blank",rel:"noopener noreferrer"}},[s._v("冰河技术"),a("OutboundLink")],1)]),s._v("，可以获得本站点所有学习内容的指导与帮助。如果你遇到不能独立解决的问题，也可以添加冰河的微信："),a("strong",[s._v("hacker_binghe")]),s._v("， 我们一起沟通交流。另外，在星球中不只能学到实用的硬核技术，还能学习"),a("strong",[s._v("实战项目")]),s._v("！")]),s._v(" "),a("p",[s._v("关注 "),a("a",{attrs:{href:"https://img-blog.csdnimg.cn/20210426115714643.jpg?raw=true",target:"_blank",rel:"noopener noreferrer"}},[s._v("冰河技术"),a("OutboundLink")],1),s._v("公众号，回复 "),a("code",[s._v("星球")]),s._v(" 可以获取入场优惠券。")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://binghe001.github.io/images/personal/xingqiu.png?raw=true",width:"180px"}}),s._v(" "),a("div",{staticStyle:{"font-size":"9px"}},[s._v("知识星球：冰河技术")]),s._v(" "),a("br")])])}),[],!1,null,null,null);a.default=e.exports}}]);
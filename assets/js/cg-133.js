(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{598:function(s,t,a){"use strict";a.r(t);var n=a(24),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_3389脚本开启代码-vbs版"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3389脚本开启代码-vbs版"}},[s._v("#")]),s._v(" 3389脚本开启代码(vbs版)")]),s._v(" "),a("p",[s._v("将以下代码复制到记事本里并保存为rots.vbs")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("on error resume next\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("utstreem")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.stdout\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("instreem")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.stdin\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lcase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("wscript.fullname,11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wscript.exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjShell")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.createObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wscript.shell"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   objShell.Run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmd.exe /k cscript. //nologo "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("wscript.scriptfullname"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("chr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n   wscript.quit\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   usage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Not enough parameters."')]),s._v("\n   wscript.quit\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ipaddress")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v("\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not isnumeric"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" or port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The number of port is error."')]),s._v("\n   wscript.quit\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reboot")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reboot")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nusage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\noutstreem.write "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Conneting "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("ipaddress"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ...."')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjlocator")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("createobject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wbemscripting.swbemlocator"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjswbemservices")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objlocator.connectserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ipaddress,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root/cimv2"')]),s._v(",username,password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nobjswbemservices.security_.privileges.add "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(",true\nobjswbemservices.security_.privileges.add "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(",true\nshowerror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\noutstreem.write "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Checking OS type...."')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("colinstoscaption")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objswbemservices.execquery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select caption from win32_operatingsystem"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each objinstoscaption "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" colinstoscaption\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" instr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objinstoscaption.caption,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n      wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OK!"')]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n      wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OS type is "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("objinstoscaption.caption\n      outstreem.write "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Do you want to cancel setup?[y/n]"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("strcancel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("instreem.read\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" lcase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strcancel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<>")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" wscript.quit\n   end "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nnext\noutstreem.write "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Writing into registry ...."')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjinstreg")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objlocator.connectserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ipaddress,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root/default"')]),s._v(",username,password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdregprov"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HKLM")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("h80000002\nwith objinstreg\n.createkey ,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Microsoft\\Windows\\CurrentVersion'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('etcache"')]),s._v("\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Microsoft\\Windows\\CurrentVersion'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('etcache"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Enabled"')]),s._v(",0\n.createkey HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"')]),s._v("\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableAdminTSRemote"')]),s._v(",1\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Control\\Terminal Server"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TSEnabled"')]),s._v(",1\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Services\\TermDD"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Start"')]),s._v(",2\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Services\\TermService"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Start"')]),s._v(",2\n.setstringvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".DEFAULT\\Keyboard Layout\\Toggle"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hotkey"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n.setdwordvalue HKLM,"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PortNumber"')]),s._v(",port\nend with\nshowerror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("lcase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reboot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/r"')]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-r"')]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   outstreem.write "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Now, reboot target...."')]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("strwqlquery")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"select * from win32_operatingsystem where primary='true'\"")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("colinstances")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objswbemservices.execquery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strwqlquery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each objinstance "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" colinstances\n      objinstance.win32shutdown"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   next\n   showerror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You need to reboot target."')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("vbcrlf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Then,"')]),s._v("\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You can logon terminal services on "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" later. Good luck!"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" showerror"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("errornumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" errornumber Then\n   wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error 0x"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cstr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ."')]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err.description "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n      wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error description: "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("err.description"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v("\n   end "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n   wscript.quit\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   wscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OK!"')]),s._v("\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" usage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nwscript.echo string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ROTS v1.01"')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Remote Open Terminal services Script, by zzzEVAzzz"')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Welcome to visite www.isgrey.com"')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage:"')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cscript. "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("wscript.scriptfullname"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" targetIP username password [port] [/r]"')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"port: default number is 3389."')]),s._v("\nwscript.echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/r: auto reboot target."')]),s._v("\nwscript.echo string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("vbcrlf\nend "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br")])]),a("p",[s._v("#######################################################\n描述：远程启动终端服务的windows脚本。\n特点：不依赖于目标的ipc$开放与否。\n原理：直接访问目标的windows管理规范服务（WMI）。该服务为系统重要服务，默认启动。\n支持平台：win2kpro win2kserver winxp win.net\n使用方法：\n在命令行方式下使用windows自带的脚本宿主程序cscript.exe调用脚本，例如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" c:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("cscript ROTS.vbs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("目标IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("用户名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("密码"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("服务端口"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("自动重起选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("服务端口： 设置终端服务的服务端口。默认是3389。\n自动重起选项： 使用/r表示安装完成后自动重起目标使设置生效。使用此参数时，端口设置不能忽略。")]),s._v(" "),a("p",[s._v("脚本会判断目标系统类型，如果不是server及以上版本，就会提示你是否要取消。\n因为pro版不能安装终端服务。\n如果你确信脚本判断错误，就继续安装好了。")]),s._v(" "),a("p",[s._v("如果要对本地使用，IP地址为127.0.0.1或者一个点（用.表示），用户名和密码都为空\n##################################")]),s._v(" "),a("h2",{attrs:{id:"写在最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写在最后"}},[s._v("#")]),s._v(" 写在最后")]),s._v(" "),a("blockquote",[a("p",[s._v("如果你觉得冰河写的还不错，请微信搜索并关注「 "),a("strong",[s._v("冰河技术")]),s._v(" 」微信公众号，跟冰河学习高并发、分布式、微服务、大数据、互联网和云原生技术，「 "),a("strong",[s._v("冰河技术")]),s._v(" 」微信公众号更新了大量技术专题，每一篇技术文章干货满满！不少读者已经通过阅读「 "),a("strong",[s._v("冰河技术")]),s._v(" 」微信公众号文章，吊打面试官，成功跳槽到大厂；也有不少读者实现了技术上的飞跃，成为公司的技术骨干！如果你也想像他们一样提升自己的能力，实现技术能力的飞跃，进大厂，升职加薪，那就关注「 "),a("strong",[s._v("冰河技术")]),s._v(" 」微信公众号吧，每天更新超硬核技术干货，让你对如何提升技术能力不再迷茫！")])]),s._v(" "),a("p",[a("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://img-blog.csdnimg.cn/20200906013715889.png",loading:"lazy"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[766],{1097:function(t,s,a){"use strict";a.r(s);var n=a(15),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"《高性能polaris网关》完整实战案例-第01节-网关访问后端服务http接口完整案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#《高性能polaris网关》完整实战案例-第01节-网关访问后端服务http接口完整案例"}},[t._v("#")]),t._v(" 《高性能Polaris网关》完整实战案例-第01节：网关访问后端服务HTTP接口完整案例")]),t._v(" "),s("p",[t._v("作者：冰河\n"),s("br"),t._v("星球："),s("a",{attrs:{href:"http://m6z.cn/6aeFbs",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://m6z.cn/6aeFbs"),s("OutboundLink")],1),t._v(" "),s("br"),t._v("博客："),s("a",{attrs:{href:"https://binghe.gitcode.host",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://binghe.gitcode.host"),s("OutboundLink")],1),t._v(" "),s("br"),t._v("文章汇总："),s("a",{attrs:{href:"https://binghe.gitcode.host/md/all/all.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://binghe.gitcode.host/md/all/all.html"),s("OutboundLink")],1),t._v(" "),s("br"),t._v("源码获取地址："),s("a",{attrs:{href:"https://t.zsxq.com/0dhvFs5oR",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/0dhvFs5oR"),s("OutboundLink")],1)]),t._v(" "),s("blockquote",[s("p",[t._v("沉淀，成长，突破，帮助他人，成就自我。")])]),t._v(" "),s("ul",[s("li",[t._v("本节难度：★★★☆☆")]),t._v(" "),s("li",[t._v("本节重点：实现网关访问后端服务HTTP接口的完整实战案例，深入理解高性能Polaris网关访问后端服务的完整流程。重点掌握整体调用链路的设计思路和设计方法，并能够将其灵活应用到自身实际项目中。")])]),t._v(" "),s("p",[t._v("设计并实现完网关的主体流程和网关的客户端SDK后，如何检验后端服务能够方便快速的对接网关？如何验证后端服务服务对接网关时，自动将自身服务实例注册到注册中心？又该如何验证网关通过服务发现自动将请求负载均衡路由到后端服务的HTTP接口？如何实现网关访问后端HTTP接口的完整案例？")]),t._v(" "),s("blockquote",[s("p",[t._v("专栏已上线，点击学习："),s("a",{attrs:{href:"https://binghe.gitcode.host/md/project/gateway/start/2024-05-19-start.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://binghe.gitcode.host/md/project/gateway/start/2024-05-19-start.html"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"一、背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[t._v("#")]),t._v(" 一、背景")]),t._v(" "),s("p",[t._v("截止到目前，我们已经完成了网关核心主体功能的设计和开发，包含：通用模型的设计与实现、通用过滤器的设计与实现、通用处理器的设计与实现、核心容器的设计与实现、启动流程的设计与实现、注册中心的设计与实现、负载均衡的设计与实现、增强型负载均衡的设计与实现、配置中心的设计与实现和网关热插拔插件的设计与实现和客户端SDK等。")]),t._v(" "),s("p",[t._v("接下来，我们就要验证设计和实现的高性能Polaris网关是否符合设计的预期，能否通过注册中心的服务注册与发现、配置中心的配置管理、通用模型的数据转换、过滤器链的请求传递、通用处理器的性能增强、核心启动容器的管理、负载均衡的路由设计、热插拔插件的功能增强和网关的异步调用和异步响应等机制完整的实现网关的核心功能。")]),t._v(" "),s("h2",{attrs:{id:"二、本节重点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、本节重点"}},[t._v("#")]),t._v(" 二、本节重点")]),t._v(" "),s("p",[t._v("实现网关访问后端服务HTTP接口的完整实战案例，深入理解高性能Polaris网关访问后端服务的完整流程。重点掌握整体调用链路的设计思路和设计方法，并能够将其灵活应用到自身实际项目中。")]),t._v(" "),s("h2",{attrs:{id:"三、实战场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、实战场景"}},[t._v("#")]),t._v(" 三、实战场景")]),t._v(" "),s("p",[t._v("本节，实现网关访问后端服务HTTP接口的完整实战案例。")]),t._v(" "),s("ul",[s("li",[t._v("启动网关和后端服务，通过网关访问后端服务接口，正确返回hello polaris。")]),t._v(" "),s("li",[t._v("停止后端服务，通过网关访问后端服务接口，返回503：后端服务暂时不可用，请稍后再试")]),t._v(" "),s("li",[t._v("再次启动后端服务，通过网关访问后端服务接口，正确返回hello polaris。")])]),t._v(" "),s("h2",{attrs:{id:"四、服务规划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、服务规划"}},[t._v("#")]),t._v(" 四、服务规划")]),t._v(" "),s("p",[t._v("实战通过高性能Polaris网关访问后端服务的规划如下所示。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("服务名")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("服务说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("端口")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("接口")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("polaris-examples-http")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("后端服务")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("8080")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("/http-server/hello-polaris")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("高性能Polaris网关")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("网关服务")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("10000")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("访问polaris-examples-http的接口用来测试")])])])]),t._v(" "),s("h2",{attrs:{id:"五、案例实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、案例实现"}},[t._v("#")]),t._v(" 五、案例实现")]),t._v(" "),s("p",[t._v("在整个实战案例实现的过程中，主要分为后端服务整合SDK和配置中心添加服务配置两个大的步骤。")]),t._v(" "),s("h3",{attrs:{id:"_5-1-后端服务整合sdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-后端服务整合sdk"}},[t._v("#")]),t._v(" 5.1 后端服务整合SDK")]),t._v(" "),s("p",[s("strong",[t._v("（1）添加客户端SDK引用")])]),t._v(" "),s("p",[t._v("在polaris-examples-http工程下的pom.xml文件中添加对网关HTTP客户端的引用依赖，如下所示。")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("io.binghe.polaris"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("polaris-examples-common"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${project.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("io.binghe.polaris"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("polaris-client-http"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${project.version}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("p",[s("strong",[t._v("（2）添加注解")])]),t._v(" "),s("p",[t._v("在后端服务的接口类上和方法上分别添加@PolarisService注解和@PolarisInvoker注解。")]),t._v(" "),s("p",[t._v("源码详见：polaris-examples-http工程下的io.binghe.polaris.examples.http.controller.HttpController。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Slf4j")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PolarisService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" protocol "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Protocol")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" patternPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/http-server/**"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PolarisInvoker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ruleId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-server-rule"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/http-server/hello-polaris"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequestMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/http-server/hello-polaris"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("helloPolaris")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello polaris"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("可以看到，在HttpController类上标注的@PolarisService注解标识了服务的id为http-server，使用的协议为http，path的匹配规则为http-server/**。在方法上标注的@PolarisInvoker注解标识了规则id为http-server-rule，访问的路径path为/http-server/hello-polaris。同时，接口的定义也为/http-server/hello-polaris。")]),t._v(" "),s("p",[t._v("这里需要需要的是@PolarisInvoker注解中的ruleId的值，需要与配置中心中某个规则的id相匹配。")]),t._v(" "),s("p",[t._v("至此，对后端服务整合HTTP客户端SDK完成，就是这么简单，添加pom.xml依赖，对接口类添加注解即可。")]),t._v(" "),s("h3",{attrs:{id:"_5-2-添加服务配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-添加服务配置"}},[t._v("#")]),t._v(" 5.2 添加服务配置")]),t._v(" "),s("p",[t._v("这里，以Nacos配置中心为例，在Nacos中添加服务配置。服务配置的DataId为polaris-gateway，Group为dev，配置内容如下：")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-server-rule"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HTTP测试配置规则"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"protocol"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"serviceId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http-server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prefix"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/http-server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"paths"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"filterRules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loadbalancerFilter"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"config"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{\\"balanceType\\" : \\"robin\\"}"')]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"httpFilter"')]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"errorFilter"')]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br")])]),s("p",[t._v("配置后的效果如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-001.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("至此，所有准备工作完成。接下来，分别启动后端服务和网关。")]),t._v(" "),s("h2",{attrs:{id:"六、启动服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、启动服务"}},[t._v("#")]),t._v(" 六、启动服务")]),t._v(" "),s("h3",{attrs:{id:"_6-1-启动后端服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-启动后端服务"}},[t._v("#")]),t._v(" 6.1 启动后端服务")]),t._v(" "),s("p",[s("strong",[t._v("（1）启动polaris-examples-http工程")])]),t._v(" "),s("p",[t._v("运行polaris-examples-http工程的io.binghe.polaris.examples.http.HttpExampleStarter启动后端服务。启动成功后会输出如下日志。")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("启动高性能Polaris网关HTTP客户端"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("strong",[t._v("（2）查看后端服务注册情况")])]),t._v(" "),s("p",[t._v("查看后端服务是否自动注册到Nacos注册中心，如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-002.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("可以看到，后端服务已经自动注册到注册中心，服务名称为http-server。")]),t._v(" "),s("p",[t._v("至此，后端服务准备就绪。")]),t._v(" "),s("h3",{attrs:{id:"_6-2-启动网关"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-启动网关"}},[t._v("#")]),t._v(" 6.2 启动网关")]),t._v(" "),s("p",[s("strong",[t._v("（1）启动polaris-core工程")])]),t._v(" "),s("p",[t._v("启动polaris-core工程下的io.binghe.polaris.core.Starter。网关启动成功会输出包含但不限于如下日志。")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("Polaris网关启动成功，监听端口:10000\n从Nacos配置中心获取到的配置为\n服务注册:\n刷新服务和服务实例:\n执行Logger插件的init方法"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[s("strong",[t._v("（2）查看服务注册情况")])]),t._v(" "),s("p",[t._v("查看网关服务是否自动注册到Nacos注册中心，如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-003.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("可以看到，启动网关后也会自动注册到注册中心，网关的服务名称为polaris。")]),t._v(" "),s("p",[t._v("至此，网关准备就绪。")]),t._v(" "),s("h2",{attrs:{id:"七、验证实战场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、验证实战场景"}},[t._v("#")]),t._v(" 七、验证实战场景")]),t._v(" "),s("p",[t._v("这里，就对网关访问后端服务HTTP接口的完整案例进行验证。")]),t._v(" "),s("h3",{attrs:{id:"_7-1-环境准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-环境准备"}},[t._v("#")]),t._v(" 7.1 环境准备")]),t._v(" "),s("p",[t._v("在apifox中，通过网关访问后端服务的接口为：http://localhost:10000/http-server/hello-polaris。")]),t._v(" "),s("p",[t._v("在请求头header中添加key为uniqueId的请求头，值为http-server:1.0.0。其中，值为后端服务的serviceId:version。也就是服务id:版本号。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-004.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("h3",{attrs:{id:"_7-2-同时启动网关和后端服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-同时启动网关和后端服务"}},[t._v("#")]),t._v(" 7.2 同时启动网关和后端服务")]),t._v(" "),s("p",[t._v("同时启动网关和后端服务，通过网关访问后端服务接口，如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-005.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("可以看到，同时启动网关和后端服务，通过网关访问后端服务接口，会正常返回hello polaris，符合预期效果。")]),t._v(" "),s("h3",{attrs:{id:"_7-3-停止后端服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-停止后端服务"}},[t._v("#")]),t._v(" 7.3 停止后端服务")]),t._v(" "),s("p",[t._v("停止后端服务，通过网关访问后端服务接口，如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-006.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("可以看到，停止后端服务，通过网关访问后端服务接口，返回503：后端服务暂时不可用，请稍后再试。")]),t._v(" "),s("p",[t._v("网关也会输出如下日志。")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("HTTP过滤器未获取到下游服务实例, 请求路径:http://192.168.1.4:8080/http-server/hello-polaris\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("符合预期效果。")]),t._v(" "),s("h3",{attrs:{id:"_7-4-恢复后端服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-恢复后端服务"}},[t._v("#")]),t._v(" 7.4 恢复后端服务")]),t._v(" "),s("p",[t._v("再次启动后端服务，通过网关访问后端服务接口，如下所示。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/project/gateway/2025-08-22-005.png?raw=true",width:"70%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("可以看到，再次启动后端服务，通过网关访问后端服务接口，正确返回hello polaris。符合预期效果。")]),t._v(" "),s("h2",{attrs:{id:"八、本节总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、本节总结"}},[t._v("#")]),t._v(" 八、本节总结")]),t._v(" "),s("p",[t._v("本节，主要实战的形式验证了网关访问后端服务HTTP接口完整案例，结果都符合预期效果。")]),t._v(" "),s("p",[t._v("希望这节内容能够为大家带来实质性的收获，最后，可以在评论区写下你学完本章节的收获，祝大家都能学有所成，我们一起搞定高性能Polaris网关。")]),t._v(" "),s("h2",{attrs:{id:"九、写在最后"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#九、写在最后"}},[t._v("#")]),t._v(" 九、写在最后")]),t._v(" "),s("p",[t._v("在冰河的知识星球除了目前正在热更的高性能网关和RPC视频外，还有其他9个项目，像DeepSeek大模型、手写高性能熔断组件、手写通用指标上报组件、手写高性能数据库路由组件、分布式IM即时通讯系统、Sekill分布式秒杀系统、手写RPC、简易商城系统等等，这些项目的需求、方案、架构、落地等均来自互联网真实业务场景，让你真正学到互联网大厂的业务与技术落地方案，并将其有效转化为自己的知识储备。")]),t._v(" "),s("p",[s("strong",[t._v("值得一提的是：冰河自研的Polaris高性能网关比某些开源网关项目性能更高，并且冰河也正在为企业级高性能RPC框架录制视频，全程带你分析原理和手撸代码。")]),t._v(" 你还在等啥？不少小伙伴经过星球硬核技术和项目的历练，早已成功跳槽加薪，实现薪资翻倍，而你，还在原地踏步，抱怨大环境不好。抛弃焦虑和抱怨，我们一起塌下心来沉淀硬核技术和项目，让自己的薪资更上一层楼。")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://binghe.gitcode.host/images/personal/xingqiu_149.png?raw=true",width:"80%"}}),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("目前，领券加入星球就可以跟冰河一起学习《DeepSeek大模型》、《手写高性能通用熔断组件项目》、《手写高性能通用监控指标上报组件》、《手写高性能数据库路由组件项目》、《手写简易商城脚手架项目》、《手写高性能RPC项目》和《Spring6核心技术与源码解析》、《实战高并发设计模式》、《分布式Seckill秒杀系统》、《分布式IM即时通讯系统》和《手写高性能Polaris网关》，从零开始介绍原理、设计架构、手撸代码。")]),t._v(" "),s("p",[s("strong",[t._v("花很少的钱就能学这么多硬核技术、中间件项目和大厂秒杀系统与分布式IM即时通讯系统，比其他培训机构不知便宜多少倍，硬核多少倍，如果是我，我会买他个十年！")])]),t._v(" "),s("p",[t._v("加入要趁早，后续还会随着项目和加入的人数涨价，而且只会涨，不会降，先加入的小伙伴就是赚到。")]),t._v(" "),s("p",[t._v("另外，还有一个限时福利，邀请一个小伙伴加入，冰河就会给一笔 "),s("strong",[t._v("分享有奖")]),t._v(" ，有些小伙伴都邀请了50+人，早就回本了！")]),t._v(" "),s("h2",{attrs:{id:"十、其他方式加入星球"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十、其他方式加入星球"}},[t._v("#")]),t._v(" 十、其他方式加入星球")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("链接")]),t._v(" ：打开链接 http://m6z.cn/6aeFbs 加入星球。")]),t._v(" "),s("li",[s("strong",[t._v("回复")]),t._v(" ：在公众号 "),s("strong",[t._v("冰河技术")]),t._v(" 回复 "),s("strong",[t._v("星球")]),t._v(" 领取优惠券加入星球。")])]),t._v(" "),s("p",[s("strong",[t._v("特别提醒：")]),t._v(" 苹果用户进圈或续费，请加微信 "),s("strong",[t._v("hacker_binghe")]),t._v(" 扫二维码，或者去公众号 "),s("strong",[t._v("冰河技术")]),t._v(" 回复 "),s("strong",[t._v("星球")]),t._v(" 扫二维码加入星球。")]),t._v(" "),s("p",[s("strong",[t._v("好了，今天就到这儿吧，我是冰河，我们下期见~~")])])])}),[],!1,null,null,null);s.default=r.exports}}]);
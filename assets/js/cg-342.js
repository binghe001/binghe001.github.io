(window.webpackJsonp=window.webpackJsonp||[]).push([[342],{641:function(s,t,a){"use strict";a.r(t);var n=a(7),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_3389脚本开启代码-vbs版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3389脚本开启代码-vbs版"}},[s._v("#")]),s._v(" 3389脚本开启代码(vbs版)")]),s._v(" "),t("p",[s._v("将以下代码复制到记事本里并保存为rots.vbs")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("on error resume next\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("utstreem")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.stdout\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("instreem")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.stdin\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lcase"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("right"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("wscript.fullname,11"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wscript.exe"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjShell")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.createObject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wscript.shell"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   objShell.Run"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmd.exe /k cscript. //nologo "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("chr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("wscript.scriptfullname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("chr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n   wscript.quit\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   usage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Not enough parameters."')]),s._v("\n   wscript.quit\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ipaddress")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v("\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not isnumeric"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" or port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The number of port is error."')]),s._v("\n   wscript.quit\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" wscript.arguments.count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reboot")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wscript.arguments"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reboot")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nusage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\noutstreem.write "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Conneting "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("ipaddress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ...."')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjlocator")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("createobject"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wbemscripting.swbemlocator"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjswbemservices")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objlocator.connectserver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ipaddress,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root/cimv2"')]),s._v(",username,password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nobjswbemservices.security_.privileges.add "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(",true\nobjswbemservices.security_.privileges.add "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(",true\nshowerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\noutstreem.write "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Checking OS type...."')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("colinstoscaption")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objswbemservices.execquery"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select caption from win32_operatingsystem"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each objinstoscaption "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" colinstoscaption\n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" instr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objinstoscaption.caption,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Server"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n      wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OK!"')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n      wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OS type is "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("objinstoscaption.caption\n      outstreem.write "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Do you want to cancel setup?[y/n]"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("strcancel")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("instreem.read\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" lcase"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strcancel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<>")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" wscript.quit\n   end "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nnext\noutstreem.write "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Writing into registry ...."')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bjinstreg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objlocator.connectserver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ipaddress,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root/default"')]),s._v(",username,password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stdregprov"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HKLM")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("h80000002\nwith objinstreg\n.createkey ,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Microsoft\\Windows\\CurrentVersion'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('etcache"')]),s._v("\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Microsoft\\Windows\\CurrentVersion'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('etcache"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Enabled"')]),s._v(",0\n.createkey HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"')]),s._v("\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SOFTWARE\\Policies\\Microsoft\\Windows\\Installer"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableAdminTSRemote"')]),s._v(",1\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Control\\Terminal Server"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TSEnabled"')]),s._v(",1\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Services\\TermDD"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Start"')]),s._v(",2\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Services\\TermService"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Start"')]),s._v(",2\n.setstringvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".DEFAULT\\Keyboard Layout\\Toggle"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hotkey"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n.setdwordvalue HKLM,"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PortNumber"')]),s._v(",port\nend with\nshowerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("lcase"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reboot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/r"')]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-r"')]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rebt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\r"}},[s._v("\\r")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n   outstreem.write "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Now, reboot target...."')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("strwqlquery")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"select * from win32_operatingsystem where primary='true'\"")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("colinstances")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("objswbemservices.execquery"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strwqlquery"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" each objinstance "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" colinstances\n      objinstance.win32shutdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   next\n   showerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You need to reboot target."')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("vbcrlf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Then,"')]),s._v("\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You can logon terminal services on "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" later. Good luck!"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" showerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("errornumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" errornumber Then\n   wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error 0x"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cstr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err.number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ."')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err.description "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n      wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error description: "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("err.description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v("\n   end "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\n   wscript.quit\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n   wscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OK!"')]),s._v("\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v("\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" usage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nwscript.echo string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ROTS v1.01"')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Remote Open Terminal services Script, by zzzEVAzzz"')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Welcome to visite www.isgrey.com"')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage:"')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cscript. "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("wscript.scriptfullname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" targetIP username password [port] [/r]"')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"port: default number is 3389."')]),s._v("\nwscript.echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/r: auto reboot target."')]),s._v("\nwscript.echo string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("vbcrlf\nend "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br")])]),t("p",[s._v("#######################################################\n描述：远程启动终端服务的windows脚本。\n特点：不依赖于目标的ipc$开放与否。\n原理：直接访问目标的windows管理规范服务（WMI）。该服务为系统重要服务，默认启动。\n支持平台：win2kpro win2kserver winxp win.net\n使用方法：\n在命令行方式下使用windows自带的脚本宿主程序cscript.exe调用脚本，例如：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" c:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("cscript ROTS.vbs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("目标IP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("用户名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("密码"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("服务端口"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("自动重起选项"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("服务端口： 设置终端服务的服务端口。默认是3389。\n自动重起选项： 使用/r表示安装完成后自动重起目标使设置生效。使用此参数时，端口设置不能忽略。")]),s._v(" "),t("p",[s._v("脚本会判断目标系统类型，如果不是server及以上版本，就会提示你是否要取消。\n因为pro版不能安装终端服务。\n如果你确信脚本判断错误，就继续安装好了。")]),s._v(" "),t("p",[s._v("如果要对本地使用，IP地址为127.0.0.1或者一个点（用.表示），用户名和密码都为空\n##################################")]),s._v(" "),t("h2",{attrs:{id:"写在最后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#写在最后"}},[s._v("#")]),s._v(" 写在最后")]),s._v(" "),t("blockquote",[t("p",[s._v("如果你觉得冰河写的还不错，请微信搜索并关注「 "),t("strong",[s._v("冰河技术")]),s._v(" 」微信公众号，跟冰河学习高并发、分布式、微服务、大数据、互联网和云原生技术，「 "),t("strong",[s._v("冰河技术")]),s._v(" 」微信公众号更新了大量技术专题，每一篇技术文章干货满满！不少读者已经通过阅读「 "),t("strong",[s._v("冰河技术")]),s._v(" 」微信公众号文章，吊打面试官，成功跳槽到大厂；也有不少读者实现了技术上的飞跃，成为公司的技术骨干！如果你也想像他们一样提升自己的能力，实现技术能力的飞跃，进大厂，升职加薪，那就关注「 "),t("strong",[s._v("冰河技术")]),s._v(" 」微信公众号吧，每天更新超硬核技术干货，让你对如何提升技术能力不再迷茫！")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://img-blog.csdnimg.cn/20200906013715889.png",loading:"lazy"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);
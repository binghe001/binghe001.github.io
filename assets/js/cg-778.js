(window.webpackJsonp=window.webpackJsonp||[]).push([[778],{1115:function(s,a,t){"use strict";t.r(a);var e=t(15),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"《实战ai大模型》生成ai应用-第10节-搭建云ide平台并安装dify"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#《实战ai大模型》生成ai应用-第10节-搭建云ide平台并安装dify"}},[s._v("#")]),s._v(" 《实战AI大模型》生成AI应用-第10节：搭建云IDE平台并安装Dify")]),s._v(" "),a("p",[s._v("作者：冰河\n"),a("br"),s._v("星球："),a("a",{attrs:{href:"http://m6z.cn/6aeFbs",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://m6z.cn/6aeFbs"),a("OutboundLink")],1),s._v(" "),a("br"),s._v("博客："),a("a",{attrs:{href:"https://binghe.gitcode.host",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://binghe.gitcode.host"),a("OutboundLink")],1),s._v(" "),a("br"),s._v("文章汇总："),a("a",{attrs:{href:"https://binghe.gitcode.host/md/all/all.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://binghe.gitcode.host/md/all/all.html"),a("OutboundLink")],1),s._v(" "),a("br"),s._v("源码获取地址："),a("a",{attrs:{href:"https://t.zsxq.com/0dhvFs5oR",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://t.zsxq.com/0dhvFs5oR"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("strong",[s._v("大家好，我是冰河~~")])]),s._v(" "),a("p",[s._v("在当前技术发展的大趋势下，开发环境正加速向云端迁移。云IDE（集成开发环境）平台不仅让开发团队能够在统一的环境中进行实时协作，还能有效减少因环境差异导致的问题，显著提升开发效率。通过浏览器即可访问的特性，使得云IDE能够在各类现代设备上无缝运行。")]),s._v(" "),a("p",[s._v("今天，我们一起深入探索如何在Ubuntu系统上搭建Code-Server云IDE平台，并集成Dify应用。Code-Server实质上是在远程服务器上运行的Microsoft Visual Studio Code，开发者可以直接通过浏览器使用完整的VS  Code功能，包括Git集成、代码调试、智能提示等丰富的编辑器特性。")]),s._v(" "),a("h2",{attrs:{id:"一、搭建docker基础环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、搭建docker基础环境"}},[s._v("#")]),s._v(" 一、搭建Docker基础环境")]),s._v(" "),a("p",[s._v("云IDE的稳定运行离不开容器化技术的支持，我们首先需要配置完善的Docker环境。")]),s._v(" "),a("h3",{attrs:{id:"_1-1-docker安装与配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-docker安装与配置"}},[s._v("#")]),s._v(" 1.1 Docker安装与配置")]),s._v(" "),a("p",[s._v("执行以下命令完成Docker的安装和基础配置：")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/install_docker.sh。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" docker.io\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--now")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n将当前用户加入 Docker 组\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("\nnewgrp "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/bin/docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_1-2-配置国内镜像加速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-配置国内镜像加速"}},[s._v("#")]),s._v(" 1.2 配置国内镜像加速")]),s._v(" "),a("p",[s._v("考虑到国内网络环境，我们需要配置Docker镜像加速器来提升拉取镜像的速度：")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/daemon.sh")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('EOF\n{\n  "registry-mirrors" : ["https://docker.registry.cyou",\n"https://docker-cf.registry.cyou",\n"https://dockercf.jsdelivr.fyi",\n"https://docker.jsdelivr.fyi",\n"https://dockertest.jsdelivr.fyi",\n"https://mirror.aliyuncs.com",\n"https://dockerproxy.com",\n"https://mirror.baidubce.com",\n"https://docker.m.daocloud.io",\n"https://docker.nju.edu.cn",\n"https://docker.mirrors.sjtug.sjtu.edu.cn",\n"https://docker.mirrors.ustc.edu.cn",\n"https://mirror.iscas.ac.cn",\n"https://docker.rainbond.cc",\n"https://do.nark.eu.org",\n"https://dc.j8.work",\n"https://dockerproxy.com",\n"https://gst6rzl9.mirror.aliyuncs.com",\n"https://registry.docker-cn.com",\n"http://hub-mirror.c.163.com",\n"http://mirrors.ustc.edu.cn/",\n"https://mirrors.tuna.tsinghua.edu.cn/",\n"http://mirrors.sohu.com/" \n],\n "insecure-registries" : [\n    "registry.docker-cn.com",\n    "docker.mirrors.ustc.edu.cn"\n    ],\n"debug": true,\n"experimental": false\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h3",{attrs:{id:"_1-3-docker-compose安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-docker-compose安装"}},[s._v("#")]),s._v(" 1.3 Docker Compose安装")]),s._v(" "),a("p",[s._v("Docker Compose是管理多容器应用的重要工具：")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/install_docker_compose.sh")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载静态编译的 docker-compose（x86_64 示例）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/v2.23.0/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /usr/local/bin/docker-compose\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加执行权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"二、部署code-server云ide"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、部署code-server云ide"}},[s._v("#")]),s._v(" 二、部署Code-Server云IDE")]),s._v(" "),a("p",[s._v("Code-Server作为云IDE的核心，我们需要仔细配置以确保其稳定性和可用性。")]),s._v(" "),a("h3",{attrs:{id:"_2-1-创建运行目录和配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-创建运行目录和配置文件"}},[s._v("#")]),s._v(" 2.1 创建运行目录和配置文件")]),s._v(" "),a("p",[s._v("合理的目录结构有助于后续维护：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" code-server\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" code-server/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" coder\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(":1000 ./coder\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" ./coder\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_2-2-配置docker-compose文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-配置docker-compose文件"}},[s._v("#")]),s._v(" 2.2 配置Docker Compose文件")]),s._v(" "),a("p",[s._v("创建"),a("code",[s._v("docker-compose.yml")]),s._v("文件，这是容器化部署的关键：")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/code-server-docker-compose.yml")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("code-server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" codercom/code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" unless"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("stopped\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" PASSWORD=binghe@qq.com  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置密码")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" TZ=Asia/Shanghai        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置时区")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /home/x58/code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server/coder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/home/coder           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置文件存储,改为自己文件")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /var/run/docker.sock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/run/docker.sock  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许容器内使用Docker（可选）")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /usr/bin/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/bin/docker          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载宿主机docker客户端")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /usr/bin/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/bin/docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("compose  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载docker-compose")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("network\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以非root用户运行（需确保UID存在）")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"18080:8080"')]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅允许本地访问")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("code-network")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[a("strong",[s._v("关键配置说明：")])]),s._v(" "),a("ul",[a("li",[s._v("挂载Docker套接字：使容器内可使用宿主机Docker")]),s._v(" "),a("li",[s._v("用户权限设置：增强安全性，避免root权限运行")]),s._v(" "),a("li",[s._v("网络隔离：创建独立网络环境")])]),s._v(" "),a("h3",{attrs:{id:"_2-3-启动code-server服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-启动code-server服务"}},[s._v("#")]),s._v(" 2.3 启动Code-Server服务")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/code_server_startup.sh")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" down "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"三、配置nginx反向代理与https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、配置nginx反向代理与https"}},[s._v("#")]),s._v(" 三、配置Nginx反向代理与HTTPS")]),s._v(" "),a("p",[s._v("直接通过IP和端口访问不够安全，我们需要配置Nginx提供HTTPS访问。")]),s._v(" "),a("h3",{attrs:{id:"_3-1-安装nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-安装nginx"}},[s._v("#")]),s._v(" 3.1 安装Nginx")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-2-生成自签名ssl证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-生成自签名ssl证书"}},[s._v("#")]),s._v(" 3.2 生成自签名SSL证书")]),s._v(" "),a("p",[s._v("对于内网环境，自签名证书足够使用且配置简单：")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/create_ssl.sh")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建SSL证书目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/nginx/ssl\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成私钥和证书（替换192.168.1.111为你的服务器IP）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" openssl req "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-x509")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-nodes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-days")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("365")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-newkey")]),s._v(" rsa:2048 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-keyout")]),s._v(" /etc/nginx/ssl/self.key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-out")]),s._v(" /etc/nginx/ssl/self.crt "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-subj")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/C=CN/ST=Beijing/L=Beijing/O=LAN/CN=192.168.1.111"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("随后，生成完整的证书配置文件")]),s._v(" "),a("p",[s._v("源码详见：deepseek-case-10/openssl.config")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndistinguished_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req_distinguished_name\nx509_extensions "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" v3_req\nprompt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("req_distinguished_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nC "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CN\nST "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Beijing\nL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Beijing\nO "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LAN\nCN "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.111  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你自己的服务器IP")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("v3_req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nkeyUsage "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" digitalSignature, keyEncipherment\nextendedKeyUsage "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" serverAuth\nsubjectAltName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" @alt_names\nbasicConstraints "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CA:FALSE\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("alt_names"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nIP.1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.111  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你自己的服务器IP")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"_3-3-配置nginx反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-配置nginx反向代理"}},[s._v("#")]),s._v(" 3.3 配置Nginx反向代理")]),s._v(" "),a("p",[s._v("创建配置文件"),a("code",[s._v("/etc/nginx/sites-available/code-server.conf")]),s._v("：")]),s._v(" "),a("h2",{attrs:{id:"查看完整文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看完整文章"}},[s._v("#")]),s._v(" 查看完整文章")]),s._v(" "),a("p",[s._v("加入"),a("a",{attrs:{href:"https://public.zsxq.com/groups/48848484411888.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("冰河技术"),a("OutboundLink")],1),s._v("知识星球，解锁完整技术文章、小册、视频与完整代码")])])}),[],!1,null,null,null);a.default=n.exports}}]);